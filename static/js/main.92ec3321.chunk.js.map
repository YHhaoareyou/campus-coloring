{"version":3,"sources":["locations.js","atoms.js","LocationsMenu.js","Home.js","ImageSwitch.js","auth.js","NewGraffitiModal.js","EditGraffitiModal.js","ActionMenu.js","Canvas.js","Graffitis.js","notificationMap.js","Header.js","App.js","reportWebVitals.js","Scene.js","RemoteScene.js","index.js","../node_modules/jsdom/lib/jsdom sync"],"names":["locations","garden","nameJA","descriptionJA","nameEN","descriptionEN","range","minLat","maxLat","minLong","maxLong","persistAtom","recoilPersist","currentLocState","atom","key","default","currentImgIdState","currentImgSrcState","currentImgAngleState","currentImgSizeState","isRemoteState","effects_UNSTABLE","userState","dangerouslyAllowMutability","MapContainer","styled","div","BasePin","i","Pin51","Pin51_60","Pin60_61","Pin55","Pin54_55","BaseDirection","locationComponentPairs","loc","Pin","Dir","direction","LocationsMenu","useTranslation","t","i18n","useState","currentCoor","setCurrentCoor","selectedLoc","setSelectedLoc","retrieveCoorFailed","setRetrieveCoorFailed","isRemote","useRecoilValue","handleRetrievingCoor","navigator","geolocation","getCurrentPosition","position","coords","error","useEffect","retrieveCoorTimer","setInterval","clearInterval","isCoorInRange","LocCoorRange","latitude","longitude","style","paddingTop","Alert","variant","margin","className","map","onClick","color","Modal","centered","show","onHide","Header","closeButton","Title","language","Body","textAlign","fontSize","src","width","alt","marginTop","to","Button","padding","Home","useRecoilState","setIsRemote","height","overflowY","ButtonGroup","disabled","size","Accordion","Item","eventKey","ListGroup","Table","striped","bordered","LeftSwitchWrapper","RightSwitchWrapper","SwitchButton","ImageSwitch","switchPrev","switchNext","Fragment","login","provider","GoogleAuthProvider","auth","getAuth","signInWithRedirect","useUser","NewGraffitiModal","isOpen","closeModal","openCanvas","mode","EditGraffitiModal","imgInfo","currentLoc","db","getDatabase","title","prompt","detail","set","ref","id","then","snap","sp","alert","window","location","href","catch","e","creator_id","s","MenuWrapper","Container","ActionButton","IntroCard","Card","props","HideMenuButton","OpenMenuButton","ActionMenu","likeTrigger","user","showNewGraffitiModal","setShowNewGraffitiModal","showEditGraffitiModal","setShowEditGraffitiModal","likes","Object","keys","length","setLikes","includes","uid","liked","setLiked","isMenuDisplayed","setIsMenuDisplayed","as","Text","borderLeft","borderTopLeftRadius","origin","pathname","prev_img_ids","marginBottom","borderRight","borderTopRightRadius","PainterMenuWrapper","DrawButton","getWindowDimensions","innerWidth","innerHeight","insertImageToCanvas","url","fabricCanvas","fabric","Image","fromURL","img","scaleToWidth","add","left","top","crossOrigin","Canvas","closeCanvas","basePrevIds","imgInfos","currentImgId","currentImgSrc","windowDimensions","setWindowDimensions","cv","useRef","lineColor","setLineColor","lineWidth","setLineWidth","Tools","Pencil","tool","setTool","canUndo","setCanUndo","canRedo","setCanRedo","angle","setAngle","isMenuOpen","setIsMenuOpen","current","_fc","addEventListener","beta","Math","round","zIndex","backgroundColor","borderBottom","name","fillColor","forceValue","onChange","prev","now","imageFormat","Row","Col","xs","Line","OverlayTrigger","trigger","placement","overlay","Popover","hex","paddingRight","display","verticalAlign","min","max","value","changeEvent","target","Select","removeSelected","copy","paste","undo","redo","confirm","clear","lastAngle","storage","getStorage","Date","dataUrl","toDataURL","uploadString","storageRef","getDownloadURL","Promise","all","dbSet","dbRef","prev_user_ids","type","username","displayName","err","Graffitis","setCurrentLoc","setCurrentImgId","setCurrentImgSrc","currentImgIdIndex","setCurrentImgIdIndex","setCurrentImgAngle","useSetRecoilState","setCurrentImgSize","canvasVisibility","setCanvasVisibility","setImgInfos","graffitiMode","setGraffitiMode","stashedImgSrc","setStashedImgSrc","initImgInfos","infos","imgInfosArr","Array","isArray","pid","queryString","parse","search","imgIdIndex","indexOf","switchImgSrc","imgId","get","exists","val","console","updateLikes","action","stashImgSrc","qs","baseIds","bid","idsObj","forEach","userGraffitiIdsSnap","prevIndex","stringify","history","replaceState","path","nextIndex","bottom","notificationMap","setTitle","notifications","setNotifications","Navbar","background","Collapse","Nav","borderColor","back","Brand","NavDropdown","drop","changeLanguage","borderTop","signOut","logout","fontWeight","border","float","nid","navigateToGraffitiFromNotification","whiteSpace","replace","split","reverse","join","Auth","children","isLoading","setIsLoading","setUser","onAuthStateChanged","useAuth","App","event","mediaDevices","getUserMedia","video","audio","stream","log","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","Scene","currentImgAngle","currentImgSize","imgSrcs","setImgSrcs","setPosition","rotation","setRotation","cos","PI","sin","renderer","arjs","RemoteScene","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","use","detector","initReactI18next","Cache","init","resources","en","translation","ja","fallbackLng","interpolation","escapeValue","Root","ReactDOM","render","document","getElementById","webpackEmptyContext","req","Error","code","resolve","module","exports"],"mappings":"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","file":"static/js/main.92ec3321.chunk.js","sourcesContent":["const locations = {\n  garden: {\n    nameJA: '中庭',\n    descriptionJA: 'テスト用',\n    nameEN: 'Courtyard',\n    descriptionEN: 'Test',\n    range: {\n      minLat: 35.0,\n      maxLat: 36.0,\n      minLong: 139.0,\n      maxLong: 140.0\n    }\n  },\n  '55': {\n    nameJA: '55号館外',\n    descriptionJA: '外の廊下から、中庭向き',\n    nameEN: 'Bldg. 55',\n    descriptionEN: 'From the corridor outside, facing the courtyard',\n    range: {\n      minLat: 35.7058,\n      maxLat: 35.7061,\n      minLong: 139.7078,\n      maxLong: 139.7083\n    }\n  },\n  '54_55': {\n    nameJA: '54、55号館の間',\n    descriptionJA: '55号館の入口前から、54-55号館連絡通路向き',\n    nameEN: 'Bldg. 54-55',\n    descriptionEN: \"From the front of Bldg. 55's entrance, facing skywalks between Bldg. 54 & 55\",\n    range: {\n      minLat: 35.70565,\n      maxLat: 35.7059,\n      minLong: 139.70775,\n      maxLong: 139.7082\n    }\n  },\n  '51': {\n    nameJA: '51号館',\n    descriptionJA: '一階の南側入口の前から、西側の地下に向ける',\n    nameEN: 'Bldg. 51',\n    descriptionEN: 'From the front of south entrance (1F), facing the basement on the West side',\n    range: {\n      minLat: 35.70575,\n      maxLat: 35.7060,\n      minLong: 139.7066,\n      maxLong: 139.7069\n    }\n  },\n  '51_60_top': {\n    nameJA: '51、60号館の間',\n    descriptionJA: '南側の空中通路から',\n    nameEN: 'Bldg. 51-60',\n    descriptionEN: 'From the south skywalk (2F)',\n    range: {\n      minLat: 35.7056,\n      maxLat: 35.7060,\n      minLong: 139.7061,\n      maxLong: 139.7065\n    }\n  },\n  '60_61': {\n    nameJA: '60、61号館の間',\n    descriptionJA: '南側の地面通路から',\n    nameEN: 'Bldg. 60-61',\n    descriptionEN: 'From the south passageway (1F)',\n    range: {\n      minLat: 35.7056,\n      maxLat: 35.7060,\n      minLong: 139.7057,\n      maxLong: 139.7061\n    }\n  }\n};\n\nexport default locations;","import { atom } from \"recoil\";\nimport { recoilPersist } from 'recoil-persist'\n\nconst { persistAtom } = recoilPersist();\n\nexport const currentLocState = atom({\n  key: 'currentLocState',\n  default: '',\n});\n\nexport const currentImgIdState = atom({\n  key: 'currentImgIdState',\n  default: '',\n});\n\nexport const currentImgSrcState = atom({\n  key: 'currentImgSrcState',\n  default: '',\n});\n\nexport const currentImgAngleState = atom({\n  key: 'currentImgAngleState',\n  default: 0,\n});\n\nexport const currentImgSizeState = atom({\n  key: 'currentImgSizeState',\n  default: null,\n});\n\nexport const isRemoteState = atom ({\n  key: 'isRemoteState',\n  default: false,\n  effects_UNSTABLE: [persistAtom],\n});\n\nexport const userState = atom ({\n  key: 'userState',\n  default: null,\n  dangerouslyAllowMutability: true,\n})","import { useState, useEffect } from 'react';\nimport { Link } from '@reach/router';\nimport Button from 'react-bootstrap/Button';\nimport Modal from 'react-bootstrap/Modal';\nimport Alert from 'react-bootstrap/Alert';\nimport styled from 'styled-components';\nimport locations from './locations';\nimport { useTranslation } from \"react-i18next\";\nimport { useRecoilValue } from 'recoil';\nimport { isRemoteState } from './atoms.js';\n\nconst MapContainer = styled.div`\n  position: relative;\n  margin: 0px auto;\n  width: 375px;\n  height: 150px;\n  background-image: url('/img/map.jpeg');\n  background-size: contain;\n`;\n\nconst BasePin = styled.i`\n  position: absolute;\n  font-size: 24px;\n`;\n\nconst PinGarden = styled(BasePin)`\n  top: 50px;\n  left: 240px;\n`;\n\nconst Pin51 = styled(BasePin)`\n  top: 75px;\n  left: 162px;\n`;\n\nconst Pin51_60 = styled(BasePin)`\n  top: 70px;\n  left: 125px;\n`;\n\nconst Pin60_61 = styled(BasePin)`\n  top: 70px;\n  left: 95px;\n`;\n\nconst Pin55 = styled(BasePin)`\n  top: 50px;\n  left: 290px;\n`;\n\nconst Pin54_55 = styled(BasePin)`\n  top: 75px;\n  left: 280px;\n`;\n\nconst BaseDirection = styled.i`\n  position: absolute;\n  font-size: 18px;\n`;\n\nconst DirGarden = styled(BaseDirection)`\n  top: 55px;\n  left: 230px;\n`;\n\nconst Dir51 = styled(BaseDirection)`\n  top: 80px;\n  left: 150px;\n`;\n\nconst Dir51_60 = styled(BaseDirection)`\n  top: 55px;\n  left: 128px;\n`;\n\nconst Dir60_61 = styled(BaseDirection)`\n  top: 55px;\n  left: 98px;\n`;\n\nconst Dir55 = styled(BaseDirection)`\n  top: 55px;\n  left: 280px;\n`;\n\nconst Dir54_55 = styled(BaseDirection)`\n  top: 98px;\n  left: 283px;\n`;\n\nconst locationComponentPairs = process.env.NODE_ENV === \"development\" ? [\n  {loc: '51', Pin: Pin51, Dir: Dir51, direction: 'left'},\n  {loc: '51_60_top', Pin: Pin51_60, Dir: Dir51_60, direction: 'up'},\n  {loc: '60_61', Pin: Pin60_61, Dir: Dir60_61, direction: 'up'},\n  {loc: '55', Pin: Pin55, Dir: Dir55, direction: 'left'},\n  {loc: '54_55', Pin: Pin54_55, Dir: Dir54_55, direction: 'down'},\n  {loc: 'garden', Pin: PinGarden, Dir: DirGarden, direction: 'left'}\n] : [\n  {loc: '51', Pin: Pin51, Dir: Dir51, direction: 'left'},\n  {loc: '51_60_top', Pin: Pin51_60, Dir: Dir51_60, direction: 'up'},\n  {loc: '60_61', Pin: Pin60_61, Dir: Dir60_61, direction: 'up'},\n  {loc: '55', Pin: Pin55, Dir: Dir55, direction: 'left'},\n  {loc: '54_55', Pin: Pin54_55, Dir: Dir54_55, direction: 'down'},\n]\n\nfunction LocationsMenu() {\n  const { t, i18n } = useTranslation();\n  const [currentCoor, setCurrentCoor] = useState(null);\n  const [selectedLoc, setSelectedLoc] = useState('');\n  const [retrieveCoorFailed, setRetrieveCoorFailed] = useState(false);\n  const isRemote = useRecoilValue(isRemoteState);\n\n  const handleRetrievingCoor = () => {\n    navigator.geolocation.getCurrentPosition(\n      function(position) {\n        setCurrentCoor(position.coords);\n        if (retrieveCoorFailed) setRetrieveCoorFailed(false);\n      },\n      function(error) {\n        setRetrieveCoorFailed(true);\n      }\n    );\n  }\n\n  useEffect(() => {\n    if (!isRemote) {\n      handleRetrievingCoor();\n      var retrieveCoorTimer = setInterval(handleRetrievingCoor, 5000);\n      return () => clearInterval(retrieveCoorTimer);\n    }\n  }, [isRemote])\n\n  const isCoorInRange = (LocCoorRange) =>\n    currentCoor && LocCoorRange\n      && (currentCoor.latitude >= LocCoorRange.minLat)\n      && (currentCoor.latitude <= LocCoorRange.maxLat)\n      && (currentCoor.longitude >= LocCoorRange.minLong)\n      && (currentCoor.longitude <= LocCoorRange.maxLong);\n\n  return (\n    <div style={{ paddingTop: '20px' }}>\n      <h3>{t(\"LocationsMenu.Choose location\")}</h3>\n      {\n        !isRemote && !currentCoor && <Alert variant=\"warning\" style={{ margin: \"1em\" }}><i className=\"bi bi-arrow-clockwise\"></i> {t(\"LocationsMenu.Retrieving location\")}</Alert>\n      }\n      {\n        !isRemote && retrieveCoorFailed && <Alert variant=\"danger\" style={{ margin: \"1em\" }}>{t(\"LocationsMenu.Failed to retrieve\")}</Alert>\n      }\n\n      <MapContainer>\n        {\n          locationComponentPairs.map(({loc, Pin, Dir, direction}) => (\n            <span>\n              <Pin key={\"pin\" + loc} onClick={() => setSelectedLoc(loc)} className='bi bi-geo-alt-fill' style={{ color: isCoorInRange(locations[loc].range) || isRemote ? 'orange' : '#a52a2a' }} />\n              <Dir key={\"dir\" + loc} onClick={() => setSelectedLoc(loc)} className={'bi bi-caret-' + direction + '-fill'} style={{ color: isCoorInRange(locations[loc].range) || isRemote ? 'orange' : '#a52a2a' }} />\n            </span>\n          ))\n        }\n      </MapContainer>\n\n      <Modal centered show={selectedLoc !== ''} onHide={() => setSelectedLoc('')}>\n        <Modal.Header closeButton>\n          <Modal.Title>{selectedLoc && (i18n.language === \"ja\" ? locations[selectedLoc].nameJA : locations[selectedLoc].nameEN)}</Modal.Title>\n        </Modal.Header>\n        <Modal.Body style={{ textAlign: 'center', fontSize: '14px' }}>\n          <p>{selectedLoc && (i18n.language === \"ja\" ? locations[selectedLoc].descriptionJA : locations[selectedLoc].descriptionEN)}</p>\n          <img src={`/img/loc/${selectedLoc}.jpeg`} width='70%' alt=\"View of the location\" />\n\n          {\n            selectedLoc && (isCoorInRange(locations[selectedLoc].range) || selectedLoc === 'garden' || isRemote)\n              ? (\n                <div style={{ marginTop: '1em' }}>\n                  {!isRemote && <Alert variant=\"success\">{t(\"LocationsMenu.Point camera\")}</Alert>}\n                  <Link to={'/' + selectedLoc}>\n                    <Button variant=\"outline-primary\">\n                      {t(\"LocationsMenu.View graffiti\")}\n                    </Button>\n                  </Link>\n                </div>\n              )\n              : (\n                <div style={{ marginTop: '1em' }}>\n                  <Alert variant=\"warning\" style={{ padding: '5px' }}>\n                    {t(\"LocationsMenu.Move here and wait\")}\n                    <br />\n                    {t(\"LocationsMenu.Please reload\")}\n                  </Alert>\n                </div>\n              )\n          }\n        </Modal.Body>\n      </Modal>\n    </div>\n  );\n}\n\nexport default LocationsMenu;\n","import LocationsMenu from './LocationsMenu';\nimport Table from 'react-bootstrap/Table';\nimport Accordion from 'react-bootstrap/Accordion';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport Button from 'react-bootstrap/Button';\nimport { useTranslation } from \"react-i18next\";\nimport { isRemoteState } from './atoms.js';\nimport { useRecoilState } from 'recoil';\n\nfunction Home() {\n  const { t } = useTranslation();\n  const [isRemote, setIsRemote] = useRecoilState(isRemoteState);\n\n  return (\n    <div style={{ height: \"calc(100vh - 56px)\", overflowY: \"auto\", marginTop: \"56px\", fontSize: '14px' }}>\n      <br />\n      <ButtonGroup>\n        <Button disabled={!isRemote} variant={isRemote ? \"outline-primary\" : \"primary\"} onClick={() => setIsRemote(false)} size=\"sm\">{!isRemote && \"✔︎\"} At Campus (AR)</Button>\n        <Button disabled={isRemote} variant={isRemote ? \"primary\" : \"outline-primary\"} onClick={() => setIsRemote(true)} size=\"sm\">{isRemote && \"✔︎\"} At Home</Button>\n      </ButtonGroup>\n\n      <LocationsMenu />\n\n      <Accordion>\n        <Accordion.Item eventKey=\"0\">\n          <Accordion.Header>{t(\"Home.Explanation\")}</Accordion.Header>\n          <Accordion.Body>\n            <ListGroup variant=\"flush\" style={{ textAlign: 'left' }}>\n              <ListGroup.Item>{t(\"Home.Explanation 1\")}</ListGroup.Item>\n              {!isRemote && <ListGroup.Item>{t(\"Home.Explanation 2\")}</ListGroup.Item>}\n              {!isRemote && <ListGroup.Item>{t(\"Home.Explanation 3\")}</ListGroup.Item>}\n              {isRemote && <ListGroup.Item>{t(\"Home.Explanation 4\")}</ListGroup.Item>}\n            </ListGroup>\n          </Accordion.Body>\n        </Accordion.Item>\n\n        <Accordion.Item eventKey=\"1\">\n          <Accordion.Header>{t(\"Home.Locations list\")}</Accordion.Header>\n          <Accordion.Body>\n            <Table striped bordered>\n              <thead>\n                <tr><th>{t(\"Home.Location\")}</th><th>{t(\"Home.Viewpoint\")}</th>{!isRemote && <th>{t(\"Home.Rain\")}</th>}</tr>\n              </thead>\n              <tbody>\n                <tr><td>{t(\"Home.55\")}</td><td>{t(\"Home.55 viewpoint\")}</td>{!isRemote && <td>◯</td>}</tr>\n                <tr><td>{t(\"Home.54-55\")}</td><td>{t(\"Home.54-55 viewpoint\")}</td>{!isRemote && <td>×</td>}</tr>\n                <tr><td>{t(\"Home.51\")}</td><td>{t(\"Home.51 viewpoint\")}</td>{!isRemote && <td>◯</td>}</tr>\n                <tr><td>{t(\"Home.51-60\")}</td><td>{t(\"Home.51-60 viewpoint\")}</td>{!isRemote && <td>◯</td>}</tr>\n                <tr><td>{t(\"Home.60-61\")}</td><td>{t(\"Home.60-61 viewpoint\")}</td>{!isRemote && <td>×</td>}</tr>\n              </tbody>\n            </Table>\n          </Accordion.Body>\n        </Accordion.Item>\n      </Accordion>\n    </div>\n  );\n}\n\nexport default Home;\n","import styled from 'styled-components';\nimport Button from 'react-bootstrap/Button';\nimport React from 'react';\n\nconst LeftSwitchWrapper = styled.div`\n  position: absolute;\n  top: 50vh;\n  left: 0;\n`\n\nconst RightSwitchWrapper = styled.div`\n  position: absolute;\n  top: 50vh;\n  right: 0;\n`\n\nconst SwitchButton = styled(Button)`\n  background: rgba(255, 255, 255, 0.3);\n  color: rgba(200, 200, 200);\n  border: none;\n  font-size: 36px;\n  padding: 0px;\n`;\n\nfunction ImageSwitch({ switchPrev, switchNext }) {\n  return(\n    <React.Fragment>\n      <LeftSwitchWrapper>\n        <SwitchButton variant=\"light\" onClick={switchPrev}><i className=\"bi bi-chevron-compact-left\"></i></SwitchButton>\n      </LeftSwitchWrapper>\n      <RightSwitchWrapper>\n        <SwitchButton variant=\"light\" onClick={switchNext}><i className=\"bi bi-chevron-compact-right\"></i></SwitchButton>\n      </RightSwitchWrapper>\n    </React.Fragment>\n  )\n}\n\nexport default ImageSwitch;","import { useEffect, useState } from \"react\";\nimport { useRecoilValue, useSetRecoilState } from \"recoil\";\nimport { userState } from './atoms';\nimport {\n  getAuth,\n  signInWithRedirect,\n  signOut,\n  onAuthStateChanged,\n  GoogleAuthProvider,\n} from \"firebase/auth\";\n\nexport const login = () => {\n  const provider = new GoogleAuthProvider();\n  const auth = getAuth();\n  return signInWithRedirect(auth, provider);\n};\n\nexport const logout = () => {\n  const auth = getAuth();\n  return signOut(auth);\n};\n\nexport const useAuth = () => {\n  const [isLoading, setIsLoading] = useState(true);\n  const setUser = useSetRecoilState(userState);\n\n  useEffect(() => {\n    const auth = getAuth();\n    return onAuthStateChanged(auth, (user) => {\n      setUser(user);\n      setIsLoading(false);\n    });\n  }, [setUser]);\n\n  return isLoading;\n};\n\nexport const useUser = () => {\n  return useRecoilValue(userState);\n};","import { Button, Modal } from 'react-bootstrap';\nimport { useTranslation } from \"react-i18next\";\n\nconst NewGraffitiModal = ({ isOpen, closeModal, openCanvas }) => {\n  const { t } = useTranslation();\n\n  const openNewGraffitiCanvas = () => {\n    openCanvas({ mode: 'new' });\n    closeModal();\n  }\n\n  const openOverwriteGraffitiCanvas = () => {\n    openCanvas({ mode: 'overwrite' });\n    closeModal();\n  }\n\n  return (\n    <Modal centered show={isOpen} onHide={closeModal}>\n      <Modal.Header closeButton>\n        <Modal.Title>{t(\"NewGraffitiModal.Which graffiti\")}</Modal.Title>\n      </Modal.Header>\n      <Modal.Body style={{ textAlign: 'center' }}>\n        <Button variant=\"outline-primary\" onClick={openNewGraffitiCanvas}>\n          {t(\"NewGraffitiModal.New graffiti\")}\n        </Button>\n        <br /><br />\n        <Button variant=\"outline-primary\" onClick={openOverwriteGraffitiCanvas}>\n          {t(\"NewGraffitiModal.Graffiti based on this one\")}\n        </Button>\n      </Modal.Body>\n    </Modal>\n  )\n}\n\nexport default NewGraffitiModal;","import { useRecoilValue } from 'recoil';\nimport { isRemoteState, currentLocState } from './atoms.js';\nimport { Button, Modal } from 'react-bootstrap';\nimport { getDatabase, ref, set } from \"firebase/database\";\nimport { useTranslation } from \"react-i18next\";\n\nconst EditGraffitiModal = ({ isOpen, closeModal, openCanvas, imgInfo }) => {\n  const isRemote = useRecoilValue(isRemoteState);\n  const currentLoc = useRecoilValue(currentLocState);\n  const { t } = useTranslation();\n\n  const openEditGraffitiCanvas = () => {\n    openCanvas({ mode: 'edit' });\n    closeModal();\n  }\n\n  const editGraffitiInfo = () => {\n    const db = getDatabase();\n    const title = prompt(t(\"EditGraffitiModal.Title label\"), imgInfo.title);\n    const detail = prompt(t(\"EditGraffitiModal.Details label\"), imgInfo.detail);\n\n    set(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_info/' + currentLoc + '/' + imgInfo.id + '/title'), title).then(snap => {\n      set(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_info/' + currentLoc + '/' + imgInfo.id + '/detail'), detail).then(sp => {\n        alert(t(\"EditGraffitiModal.Updated\"));\n        window.location.href = \"/\" + currentLoc + \"?pid=\" + imgInfo.id;\n      }).catch(e => alert(e));\n    }).catch(e => alert(e));\n  }\n\n  const deleteGraffiti = () => {\n    const db = getDatabase();\n    set(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_urls/' + currentLoc + '/' + imgInfo.id), null).then(snap => {\n      set(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_info/' + currentLoc + '/' + imgInfo.id), null).then(sp => {\n        set(ref(db, (isRemote ? \"remote/\" : \"\") + 'users/' + imgInfo.creator_id + '/img_ids/' + currentLoc + '/' + imgInfo.id), null).then(s => {\n          alert(t(\"EditGraffitiModal.Deleted\"));\n          window.location.href = \"/\" + currentLoc;\n        }).catch(e => alert(e));\n      }).catch(e => alert(e));\n    }).catch(e => alert(e));\n  }\n\n  return (\n    <Modal centered show={isOpen} onHide={closeModal}>\n      <Modal.Header closeButton>\n        <Modal.Title>{t(\"EditGraffitiModal.Edit/Delete\")}</Modal.Title>\n      </Modal.Header>\n      <Modal.Body style={{ textAlign: 'center' }}>\n        <Button variant=\"outline-primary\" onClick={openEditGraffitiCanvas}>\n          <i className='bi bi-pencil-square' /> {t(\"EditGraffitiModal.Edit graffiti\")}\n        </Button>\n        <br /><br />\n        <Button variant=\"outline-primary\" onClick={editGraffitiInfo}>\n          <i className='bi bi-brush' /> {t(\"EditGraffitiModal.Edit title and details\")}\n        </Button>\n        <br /><br />\n        <Button variant=\"outline-danger\" onClick={deleteGraffiti}>\n          <i className='bi bi-trash' /> {t(\"EditGraffitiModal.Delete\")}\n        </Button>\n      </Modal.Body>\n    </Modal>\n  )\n}\n\nexport default EditGraffitiModal;","import { useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport { Container, Row, ButtonGroup, Button, Card, Modal } from 'react-bootstrap';\nimport { useUser } from './auth';\nimport NewGraffitiModal from './NewGraffitiModal';\nimport EditGraffitiModal from './EditGraffitiModal';\nimport { useTranslation } from \"react-i18next\";\n\nconst MenuWrapper = styled(Container)`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  background-color: transparent;\n  padding-bottom: 10px;\n`\n\nconst ActionButton = styled(Button)`\n  background: transparent;\n  border: 0.5px solid #fff;\n  border-bottom: none;\n  height: 30px;\n  color: #fff;\n`\n\nconst IntroCard = styled(Card)`\n  ${props => !props.isOpen && 'display: none;'}\n  height: 100px;\n  overflow-y: scroll;\n  background-color: rgba(0, 0, 0, 0.4);\n  color: #fff;\n  border: 0.5px solid #fff;\n  border-radius: 10px;\n`;\n\nconst HideMenuButton = styled(Button)`\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  width: 25px;\n  height: 25px;\n  padding: 0px;\n  background-color: transparent;\n  border: none;\n  font-size: 24px;\n  line-height: 0px;\n  border-radius: 50%;\n`;\n\nconst OpenMenuButton = styled(Button)`\n  width: 100%;\n  height: 30px;\n  padding: 0px;\n  font-size: 36px;\n  line-height: 0px;\n  background: rgba(255, 255, 255, 0.3);\n  color: rgb(200, 200, 200);\n  border: none;\n`;\n\nfunction ActionMenu({ imgInfo, openCanvas, likeTrigger }) {\n  const user = useUser();\n  const [showNewGraffitiModal, setShowNewGraffitiModal] = useState(false);\n  const [showEditGraffitiModal, setShowEditGraffitiModal] = useState(false);\n  const [likes, setLikes] = useState(imgInfo.likes ? Object.keys(imgInfo.likes).length : 0)\n  const [liked, setLiked] = useState(imgInfo.likes && Object.keys(imgInfo.likes).includes(user.uid))\n  const [isMenuDisplayed, setIsMenuDisplayed] = useState(true)\n  const { t } = useTranslation();\n\n  const handleLikeTrigger = () => {\n    likeTrigger();\n    setLikes(liked ? likes - 1 : likes + 1);\n    setLiked(!liked);\n  }\n\n  const navigateToBaseGraffitis = () => {\n    window.location.href = window.location.origin + window.location.pathname + '?mode=base&bid=' + imgInfo.id;\n  }\n\n  const navigateToUserGraffitis = () => {\n    window.location.href = window.location.origin + window.location.pathname + '?mode=user&uid=' + imgInfo.creator_id;\n  }\n\n  useEffect(() => {\n    setLikes(imgInfo.likes ? Object.keys(imgInfo.likes).length : 0);\n    setLiked(imgInfo.likes && Object.keys(imgInfo.likes).includes(user.uid));\n  }, [imgInfo]);\n\n  return (\n    <MenuWrapper>\n      {!isMenuDisplayed && <OpenMenuButton variant='outline-light' onClick={() => setIsMenuDisplayed(true)}><i className='bi bi-chevron-compact-up' /></OpenMenuButton>}\n\n      <IntroCard isOpen={isMenuDisplayed}>\n        <Card.Body style={{ padding: 0, position: 'relative' }}>\n          <HideMenuButton variant='outline-light' onClick={() => setIsMenuDisplayed(false)}><i className='bi bi-x' /></HideMenuButton>\n          <Card.Title as='h6' style={{ height: '15px', margin: '5px' }}>{imgInfo.title}</Card.Title>\n          <Card.Text style={{ fontSize: '14px', height: '40px', margin: '5px' }}>\n            {imgInfo.detail}\n          </Card.Text>\n          <ButtonGroup style={{ width: '100%', margin: 0, height: '30px' }}>\n            {\n              imgInfo.creator_id === user.uid ? (\n                <ActionButton variant='light' size='sm' onClick={() => setShowEditGraffitiModal(true)} style={{ borderLeft: 'none', borderTopLeftRadius: 0 }}>\n                  <i className=\"bi bi-gear\"></i>\n                  {' '}{t(\"ActionMenu.Edit/Delete\")}\n                </ActionButton>\n              ) : (\n                <ActionButton variant='light' size='sm' onClick={navigateToUserGraffitis} style={{ borderLeft: 'none', borderTopLeftRadius: 0 }}>\n                  <i className=\"bi bi-person\"></i>\n                  {' '}{t(\"ActionMenu.User\")}\n                </ActionButton>\n              )\n            }\n            {\n              imgInfo?.prev_img_ids && (\n                <ActionButton variant='light' size='sm' onClick={navigateToBaseGraffitis} style={{ marginBottom: 0 }}>\n                  <i className=\"bi bi-collection\"></i>\n                  {' '}{t(\"ActionMenu.Based works\")}\n                </ActionButton>\n              )\n            }\n            <ActionButton variant='light' size='sm' onClick={handleLikeTrigger}>\n              <i className={liked ? \"bi bi-heart-fill\" : \"bi bi-heart\"}></i>\n              {' '}{likes}\n            </ActionButton>\n            <ActionButton variant='light' size='sm' onClick={() => setShowNewGraffitiModal(true)} style={{ borderRight: 'none', borderTopRightRadius: 0 }}>\n              <i className=\"bi bi-pencil\"></i>\n              {' '}{t(\"ActionMenu.Paint yours\")}\n            </ActionButton>\n          </ButtonGroup>\n        </Card.Body>\n      </IntroCard>\n\n      <NewGraffitiModal isOpen={showNewGraffitiModal} closeModal={() => setShowNewGraffitiModal(false)} openCanvas={openCanvas} />\n      <EditGraffitiModal isOpen={showEditGraffitiModal} closeModal={() => setShowEditGraffitiModal(false)} openCanvas={openCanvas} imgInfo={imgInfo} />\n\n    </MenuWrapper>\n  )\n}\n\nexport default ActionMenu;","import { useEffect, useState, useRef } from 'react';\nimport { getDatabase, ref as dbRef, set as dbSet } from \"firebase/database\";\nimport { getStorage, ref as storageRef, uploadString, getDownloadURL } from \"firebase/storage\";\nimport { useRecoilValue } from 'recoil';\nimport { isRemoteState, currentLocState, currentImgIdState, currentImgSrcState } from './atoms.js';\nimport styled from 'styled-components';\nimport { Container, Row, Col, Button, ButtonGroup, OverlayTrigger, Popover } from 'react-bootstrap';\nimport { useUser } from './auth'\nimport { useTranslation } from \"react-i18next\";\n\nimport { CompactPicker } from 'react-color';\nimport { SketchField, Tools } from 'react-sketch';\nimport RangeSlider from 'react-bootstrap-range-slider';\nimport { fabric } from \"fabric\";\n\nconst PainterMenuWrapper = styled(Container)`\n  ${props => !props.isOpen && 'display: none;'}\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100vw;\n  height: 80px;\n  padding: 0px;\n  background-color: transparent;\n`;\n\nconst DrawButton = styled(Button)`\n  margin: 0px 3px;\n  padding: 0px;\n  width: 35px;\n  height: 35px;\n  border-radius: 50%;\n  border: 0.5px solid #fff;\n  background-color: rgba(0, 0, 0, 0.4);\n  color: #fff;\n  @media (max-width: 374px) {\n    margin: 0px 1px;\n    width: 35px;\n    height: 35px;\n  }\n`;\n\nconst ActionButton = styled(Button)`\n  padding: 3px 0px;\n  border: 0.5px solid #fff;\n  background-color: rgba(0, 0, 0, 0.4);\n  color: #fff;\n`;\n\nconst HideMenuButton = styled(Button)`\n  position: absolute;\n  bottom: 80px;\n  right: 5px;\n  padding: 0px;\n  width: 35px;\n  height: 35px;\n  border-radius: 50%;\n  border: 0.5px solid rgba(0, 0, 0, 0.4);\n  background-color: transparent;\n  color: rgba(0, 0, 0, 0.4);\n  font-size: 24px;\n`;\n\nconst OpenMenuButton = styled(Button)`\n  position: absolute;\n  left: 0px;\n  bottom: 0px;\n  width: 100%;\n  height: 30px;\n  padding: 0px;\n  font-size: 36px;\n  line-height: 0px;\n  background: rgba(255, 255, 255, 0.3);\n  color: rgb(200, 200, 200);\n  border: none;\n`;\n\nfunction getWindowDimensions() {\n  const { innerWidth: width, innerHeight: height } = window;\n  return {\n    width,\n    height\n  };\n}\n\nfunction insertImageToCanvas(url, fabricCanvas) {\n  fabric.Image.fromURL(\n    url,\n    function (img) {\n      img.scaleToWidth(getWindowDimensions().width);\n      fabricCanvas.add(img.set({\n        left: 0,\n        top: 0,\n      }));\n    },\n    {\n      crossOrigin: 'Anonymous'\n    }\n  )\n}\n\nconst Canvas = ({ closeCanvas, basePrevIds, mode, imgInfos, imgInfo }) => {\n  const { t } = useTranslation();\n  const user = useUser();\n  const isRemote = useRecoilValue(isRemoteState);\n  const currentLoc = useRecoilValue(currentLocState);\n  const currentImgId = useRecoilValue(currentImgIdState);\n  const currentImgSrc = useRecoilValue(currentImgSrcState);\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\n\n  const cv = useRef(null);\n  const [ lineColor, setLineColor ] = useState('#000');\n  const [ lineWidth, setLineWidth ] = useState(5);\n  const [ tool, setTool ] = useState(Tools.Pencil);\n  const [ canUndo, setCanUndo ] = useState(false);\n  const [ canRedo, setCanRedo ] = useState(false);\n  const [ angle, setAngle ] = useState(0);\n  const [ isMenuOpen, setIsMenuOpen ] = useState(true);\n\n  // load base graffiti on canvas\n  useEffect(() => {\n    setWindowDimensions(getWindowDimensions());\n    if (mode !== 'new') {\n      insertImageToCanvas(currentImgSrc, cv.current._fc);\n    }\n  }, [mode, currentImgSrc]);\n\n  useEffect(() => {\n    window.addEventListener(\"deviceorientation\", function(e){\n      const { beta } = e;\n      setAngle(Math.round(beta * 100) / 100)\n    });\n  }, [])\n\n  const undo = () => {\n    cv.current.undo();\n    setCanUndo(cv.current.canUndo());\n    setCanRedo(cv.current.canRedo());\n  };\n\n  const redo = () => {\n    cv.current.redo();\n    setCanUndo(cv.current.canUndo());\n    setCanRedo(cv.current.canRedo());\n  };\n\n  const clear = () => {\n    if(!window.confirm(t(\"Canvas.Clear confirm\"))) return;\n    cv.current.clear();\n    setCanUndo(cv.current.canUndo());\n    setCanRedo(cv.current.canRedo());\n    if (mode !== 'new') {\n      insertImageToCanvas(currentImgSrc, cv.current._fc);\n    }\n  };\n\n  const duplicateSelected = () => {\n    try {\n      cv.current.copy();\n      cv.current.paste();\n    } catch (error) {\n      alert(t(\"Canvas.Select before duplicate\"))\n    }\n  }\n\n  const removeSelected = () => {\n    try {\n      cv.current.removeSelected();\n    } catch (error) {\n      alert(t(\"Canvas.Select before delete\"))\n    }\n  }\n\n  // Todo: save draft\n\n  const onSketchChange = () => {\n    let prev = canUndo;\n    let now = cv.current?.canUndo();\n    if (prev !== now) setCanUndo(now);\n  };\n\n  const saveCanvas = () => {\n    var lastAngle;\n\n    if (!isRemote) {\n      if(!window.confirm(t(\"Canvas.Please fix tilt\"))) return;\n      \n      lastAngle = angle;\n      if (lastAngle) {\n        alert(t(\"Canvas.Tilt retrieved\"));\n      } else {\n        alert(t(\"Canvas.Error\"));\n        return;\n      }\n    }\n\n    var title, detail, id;\n    const storage = getStorage();\n    const db = getDatabase();\n\n    title = prompt(t(\"Canvas.Title label\"), mode === 'edit' ? imgInfo.title : '');\n    if (title === null) return;\n    detail = prompt(t(\"Canvas.Details label\"), mode === 'edit' ? imgInfo.detail : '');\n    if (detail === null) return;\n\n    id = mode === 'edit' ? currentImgId : Date.now();\n    if (title === \"\") title = id;\n\n    const dataUrl = cv.current.toDataURL();\n\n    uploadString(storageRef(storage, 'paintings/' + title), dataUrl, 'data_url')\n      .then(snap => getDownloadURL(snap.ref))\n      .then(url => {\n\n        Promise.all([\n          dbSet(dbRef(db, (isRemote ? \"remote/\" : \"\") + 'img_urls/' + currentLoc + '/' + id), url), // save url\n          dbSet(dbRef(db, (isRemote ? \"remote/\" : \"\") + 'img_info/' + currentLoc + '/' + id), {\n            title,\n            detail,\n            angle: isRemote ? null : lastAngle,\n            size: {\n              width: windowDimensions.width,\n              height: windowDimensions.height - 120,\n            },\n            creator_id: user.uid,\n            prev_img_ids: mode === 'overwrite' && { [currentImgId]: true, ...basePrevIds }\n          }), // save info\n          dbSet(dbRef(db, (isRemote ? \"remote/\" : \"\") + 'users/' + user.uid + '/img_ids/' + currentLoc + '/' + id), true) // add img id to user\n        ]).then(snap => {\n\n          // send notifications\n          const prev_user_ids = imgInfos.map(img => img.creator_id);\n          Promise.all(prev_user_ids.map(uid => dbSet(dbRef(db, (isRemote ? \"remote/\" : \"\") + 'users/' + uid + '/notifications/' + id), {\n            type: 0,\n            loc: currentLoc,\n            username: user.displayName\n          })))\n            .then(s => {\n              dbSet(dbRef(db, (isRemote ? \"remote/\" : \"\") + 'users/' + user.uid + '/name'), user.displayName)\n                .then(snap => {\n\n                  // upload success & reload\n                  alert(t(\"Canvas.Uploaded\"));\n                  closeCanvas();\n                  window.location.href = \"/\" + currentLoc + \"?pid=\" + id\n\n                }).catch(err => alert(err));\n            }).catch(err => alert(err));\n        }).catch(err => alert(err));\n      }).catch(err => alert(err));\n  }\n\n  const confirmCloseCanvas = () => {\n    window.confirm(t(\"Canvas.Confirm close canvas\")) && closeCanvas();\n  }\n\n  const colorSelector = (props) => (\n    <Popover {...props} style={{ ...props.style, padding: '10px' }}>\n      <CompactPicker\n        id='lineColor'\n        color={lineColor}\n        onChange={(color) => setLineColor(color.hex)}\n      />\n    </Popover>\n  )\n\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        zIndex: 1000,\n        left: 0,\n        backgroundColor: \"rgba(255, 255, 255, 0.5)\",\n        borderBottom: \"5px solid #aaa\"\n      }}\n    >\n      <SketchField\n        name=\"sketch\"\n        className=\"canvas-area\"\n        ref={cv}\n        lineColor={lineColor}\n        lineWidth={lineWidth}\n        fillColor='transparent'\n        width={windowDimensions.width}\n        height={windowDimensions.height}\n        forceValue\n        onChange={onSketchChange}\n        tool={tool}\n        imageFormat={'jpeg'}\n      />\n\n      {\n        isMenuOpen\n          ? <HideMenuButton variant='outline-light' onClick={() => setIsMenuOpen(false)}><i className='bi bi-x' /></HideMenuButton>\n          : <OpenMenuButton variant='outline-light' onClick={() => setIsMenuOpen(true)}><i className='bi bi-chevron-compact-up' /></OpenMenuButton>\n        }\n\n      <PainterMenuWrapper isOpen={isMenuOpen}>\n        <Row style={{ padding: '0px 15px', marginBottom: '10px' }}>\n          <Col xs={4} style={{ padding: 0 }}>\n            <DrawButton variant={tool === Tools.Pencil ? \"secondary\" : \"light\"} onClick={() => setTool(Tools.Pencil)}><i className=\"bi bi-pencil\" /></DrawButton>\n            <DrawButton variant={tool === Tools.Line ? \"secondary\" : \"light\"} onClick={() => setTool(Tools.Line)}><i className=\"bi bi-slash-lg\" /></DrawButton>\n            <OverlayTrigger trigger=\"click\" placement=\"top\" overlay={colorSelector} style={{ position: 'relative' }}>\n              <DrawButton variant='light' style={{ backgroundColor: '#fff' }}>\n                <i className=\"bi bi-palette\" style={{ color: lineColor }} />{\" \"}\n              </DrawButton>\n            </OverlayTrigger>\n          </Col>\n          <Col xs={4} style={{ paddingRight: '5px', padding: 0 }}>\n            <div>\n              <span style={{ fontSize: '12px' }}><i className=\"bi bi-border-width\" /></span>{\" \"}\n              <div style={{ display: 'inline-block', verticalAlign: 'middle' }}>\n                <RangeSlider\n                  min={1}\n                  max={15}\n                  value={lineWidth}\n                  style={{ width: '80px' }}\n                  onChange={changeEvent => setLineWidth(changeEvent.target.value)}\n                />\n              </div>\n            </div>\n          </Col>\n          <Col xs={4} style={{ padding: 0 }}>\n            <DrawButton variant={tool === Tools.Select ? \"secondary\" : \"light\"} onClick={() => setTool(Tools.Select)}><i className=\"bi bi-hand-index-thumb\" /></DrawButton>\n            <DrawButton disabled={tool !== Tools.Select} variant='light' onClick={removeSelected}><i className='bi bi-trash' /></DrawButton>\n            <DrawButton disabled={tool !== Tools.Select} variant='light' onClick={duplicateSelected}><i className='bi bi-files' /></DrawButton>\n          </Col>\n        </Row>\n\n        <ButtonGroup style={{ width: '100%' }}>\n          <ActionButton disabled={!canUndo} variant='light' onClick={undo}><i className='bi bi-arrow-90deg-left' /></ActionButton>\n          <ActionButton disabled={!canRedo} variant='light' onClick={redo}><i className='bi bi-arrow-90deg-right' /></ActionButton>\n          <ActionButton variant='light' onClick={clear}><i className='bi bi-arrow-counterclockwise' /></ActionButton>\n          <ActionButton variant='light' onClick={saveCanvas}><i className='bi bi-check-lg' /> {t(\"Canvas.Done\")}</ActionButton>\n          <ActionButton variant='light' onClick={confirmCloseCanvas}><i className='bi bi-x-lg' /> {t(\"Canvas.Cancel\")}</ActionButton>\n        </ButtonGroup>\n      </PainterMenuWrapper>\n    </div>\n  )\n};\n\nexport default Canvas;","import { useEffect, useState } from 'react';\nimport ImageSwitch from './ImageSwitch';\nimport ActionMenu from './ActionMenu';\nimport Canvas from './Canvas';\nimport { useRecoilState, useSetRecoilState, useRecoilValue } from 'recoil';\nimport { isRemoteState, currentImgIdState, currentImgSrcState, currentImgAngleState, currentImgSizeState, currentLocState } from './atoms.js';\nimport { getDatabase, ref, get, set } from \"firebase/database\";\nimport { useUser } from './auth'\nimport queryString from 'query-string';\nimport Button from 'react-bootstrap/Button';\nimport { useTranslation } from \"react-i18next\";\n\nfunction Graffitis({ loc, location }) {\n  const { t } = useTranslation();\n  const isRemote = useRecoilValue(isRemoteState);\n  const [currentLoc, setCurrentLoc] = useRecoilState(currentLocState);\n  const [currentImgId, setCurrentImgId] = useRecoilState(currentImgIdState);\n  const [currentImgSrc, setCurrentImgSrc] = useRecoilState(currentImgSrcState);\n  const [currentImgIdIndex, setCurrentImgIdIndex] = useState(0);\n  const setCurrentImgAngle = useSetRecoilState(currentImgAngleState);\n  const setCurrentImgSize = useSetRecoilState(currentImgSizeState);\n  const [canvasVisibility, setCanvasVisibility] = useState(false);\n  const [imgInfos, setImgInfos] = useState([]);\n  const [graffitiMode, setGraffitiMode] = useState('new');\n  const [stashedImgSrc, setStashedImgSrc] = useState(currentImgSrc);\n  const user = useUser();\n\n  const switchToPrevImg = () => {\n    if (imgInfos.length > 1) {\n      const prevIndex = currentImgIdIndex === 0 ? imgInfos.length - 1 : currentImgIdIndex - 1;\n      setCurrentImgIdIndex(prevIndex);\n      setCurrentImgId(imgInfos[prevIndex].id);\n      switchImgSrc(imgInfos[prevIndex].id);\n      setCurrentImgAngle(imgInfos[prevIndex].angle);\n      setCurrentImgSize(imgInfos[prevIndex].size);\n\n      var qs = queryString.parse(location.search);\n      qs.pid = imgInfos[prevIndex].id;\n      const url = window.location.origin + window.location.pathname + '?' + queryString.stringify(qs);\n      window.history.replaceState({ path: url }, '', url)\n    }\n  }\n\n  const switchToNextImg = () => {\n    if (imgInfos.length > 1) {\n      const nextIndex = currentImgIdIndex === imgInfos.length - 1 ? 0 : currentImgIdIndex + 1;\n      setCurrentImgIdIndex(nextIndex);\n      setCurrentImgId(imgInfos[nextIndex].id);\n      switchImgSrc(imgInfos[nextIndex].id);\n      setCurrentImgAngle(imgInfos[nextIndex].angle);\n      setCurrentImgSize(imgInfos[nextIndex].size);\n\n      var qs = queryString.parse(location.search);\n      qs.pid = imgInfos[nextIndex].id;\n      const url = window.location.origin + window.location.pathname + '?' + queryString.stringify(qs);\n      window.history.replaceState({ path: url }, '', url)\n    }\n  }\n\n  const initImgInfos = (infos) => {\n    var imgInfosArr = infos;\n    if (!Array.isArray(infos)) {\n      imgInfosArr = Object.keys(infos).map(id => ({\n        id: id,\n        ...infos[id]\n      }))\n    }\n\n    const pid = queryString.parse(location.search).pid;\n    setImgInfos(imgInfosArr);\n    setCurrentImgId(pid || imgInfosArr[0].id);\n    const imgIdIndex = pid ? imgInfosArr.map(img => img.id).indexOf(pid) : 0;\n    setCurrentImgIdIndex(imgIdIndex);\n    switchImgSrc(pid || imgInfosArr[0].id);\n    setCurrentImgAngle(imgInfosArr[imgIdIndex].angle);\n    setCurrentImgSize(imgInfosArr[imgIdIndex].size);\n  }\n\n  const switchImgSrc = (imgId) => {\n    const db = getDatabase();\n    get(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_urls/' + loc + '/' + imgId)).then(snap => {\n      if(snap.exists()){\n        setCurrentImgSrc(snap.val())\n      }\n    }).catch(err => console.error(err));\n  }\n\n  const updateLikes = (action) => {\n    var infos = imgInfos;\n    if (action === 1) {\n      infos[currentImgIdIndex].likes = {\n        ...infos[currentImgIdIndex].likes,\n        [user.uid]: true\n      };\n    } else {\n      delete infos[currentImgIdIndex].likes[user.uid]\n    }\n    setImgInfos(infos);\n  }\n\n  const likeTrigger = () => {\n    const db = getDatabase();\n    if (imgInfos[currentImgIdIndex].likes && imgInfos[currentImgIdIndex].likes[user.uid]) {\n      set(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_info/' + loc + '/' + currentImgId + '/likes/' + user.uid), null).then(snap => updateLikes(-1)).catch(err => alert(err));\n    } else {\n      set(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_info/' + loc + '/' + currentImgId + '/likes/' + user.uid), true).then(snap => {\n        updateLikes(1);\n        set(ref(db, (isRemote ? \"remote/\" : \"\") + 'users/' + imgInfos[currentImgIdIndex].creator_id + '/notifications/' + currentImgId), {\n          type: 1,\n          loc: currentLoc,\n          username: imgInfos[currentImgIdIndex].likes && Object.keys(imgInfos[currentImgIdIndex].likes).length > 1 ? user.displayName + \"と他の\" + (Object.keys(imgInfos[currentImgIdIndex].likes).length - 1) + \"人\" : user.displayName\n        })\n      }).catch(err => alert(err));\n    }\n  }\n\n  const stashImgSrc = () => {\n    setStashedImgSrc(currentImgSrc);\n    setCurrentImgSrc('');\n  }\n\n  const popImgSrc = () => {\n    setCurrentImgSrc(stashedImgSrc);\n  }\n\n  useEffect(() => {\n    setCurrentLoc(loc);\n\n    const qs = queryString.parse(location.search)\n    const db = getDatabase();\n    get(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_info/' + loc)).then(snap => {\n      if(snap.exists()){\n        if (qs.mode && qs.mode === 'base') {\n          const baseIds = Object.keys(snap.val()[qs.bid].prev_img_ids);\n          var idsObj = {};\n          baseIds.forEach(id => {\n            idsObj[id] = snap.val()[id]\n          });\n          initImgInfos(idsObj);\n        } else if (qs.mode && qs.mode === 'user') {\n          get(ref(db, (isRemote ? \"remote/\" : \"\") + 'users/' + qs.uid + '/img_ids/' + loc)).then(userGraffitiIdsSnap => {\n            var idsObj = {};\n            if (userGraffitiIdsSnap.val()) {\n              Object.keys(userGraffitiIdsSnap.val()).forEach(id => {\n                idsObj[id] = snap.val()[id]\n              });\n              initImgInfos(idsObj);\n            }\n          })\n        } else {\n          initImgInfos(snap.val());\n        }\n      }\n    }).catch(err => console.error(err));\n  }, [])\n\n  return (\n    <div>\n      <ImageSwitch switchPrev={switchToPrevImg} switchNext={switchToNextImg} />\n      {\n        canvasVisibility && (\n          <Canvas\n            mode={graffitiMode}\n            basePrevIds={imgInfos[currentImgIdIndex]?.prev_img_ids || {}}\n            closeCanvas={() => { setCanvasVisibility(false); popImgSrc(); }}\n            imgInfos={imgInfos}\n            imgInfo={imgInfos[currentImgIdIndex]}\n          />\n        )\n      }\n      {\n        !canvasVisibility && (\n          imgInfos.length > 0\n            ? (\n              <ActionMenu\n                imgInfo={imgInfos[currentImgIdIndex]}\n                openCanvas={({ mode }) => {setCanvasVisibility(true); setGraffitiMode(mode); stashImgSrc();}}\n                likeTrigger={likeTrigger}\n              />\n            )\n            : (\n              <Button\n                style={{ position: 'absolute', bottom: 0, left: 0, width: '100vw' }}\n                onClick={() => {setCanvasVisibility(true); setGraffitiMode('new'); stashImgSrc();}}\n              >{t(\"Graffitis.Paint first graffiti\")}</Button>\n            )\n        )\n      }\n    </div>\n  );\n}\n\nexport default Graffitis;\n","const notificationMap = [\n  \"Painted based on yours\",\n  \"Liked your graffiti\"\n];\n\nexport default notificationMap;","import { Navbar, Nav, NavDropdown, Container, Button, Row, Col } from 'react-bootstrap';\nimport { login, logout, useUser } from './auth';\nimport locations from './locations';\nimport { isRemoteState, currentLocState } from './atoms';\nimport { useRecoilValue } from 'recoil';\nimport queryString from 'query-string';\nimport { useEffect, useState } from 'react';\nimport { getDatabase, ref, get, set } from \"firebase/database\";\nimport notificationMap from './notificationMap';\nimport { useTranslation } from \"react-i18next\";\n\nfunction Header() {\n  const user = useUser();\n  const isRemote = useRecoilValue(isRemoteState);\n  const loc = useRecoilValue(currentLocState);\n  const [title, setTitle] = useState('Campus as Canvas');\n  const [notifications, setNotifications] = useState({});\n  const { t, i18n } = useTranslation();\n\n  const handleLogin = () => {\n    login().catch((error) => console.error(error));\n  };\n\n  const handleLogout = () => {\n    logout().catch((error) => console.error(error));\n  };\n\n  const navigateToMyGraffitis = () => {\n    window.location.href = window.location.origin + window.location.pathname + '?mode=user&uid=' + user.uid;\n  }\n\n  const navigateToGraffitiFromNotification = (location, nid) => {\n    set(ref(getDatabase(), (isRemote ? \"remote/\" : \"\") + 'users/' + user.uid + '/notifications/' + nid), null)\n      .then(snap => window.location.href = window.location.origin + '/' + location + '?pid=' + nid)\n      .catch(err => alert(err));\n  }\n\n  const clearNotifications = () => {\n    set(ref(getDatabase(), (isRemote ? \"remote/\" : \"\") + 'users/' + user.uid + '/notifications/'), null);\n    setNotifications({});\n  }\n\n  useEffect(() => {\n    const db = getDatabase();\n    const qs = queryString.parse(window.location.search);\n    if (qs.mode && qs.mode === 'base') {\n      get(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_info/' + loc + '/' + qs.bid + '/title')).then(snap => {\n        setTitle('「' + snap.val() + '」のベース作品');\n      })\n    } else if (qs.mode && qs.mode === 'user') {\n      get(ref(db, (isRemote ? \"remote/\" : \"\") + 'users/' + qs.uid + '/name')).then(snap => {\n        setTitle(snap.val() + 'の作品');\n      })\n    } else {\n      if (loc) setTitle(locations[loc].name)\n    }\n\n    user && get(ref(db, (isRemote ? \"remote/\" : \"\") + 'users/' + user.uid + '/notifications')).then(snap => {\n      setNotifications(snap.val());\n    })\n  }, [loc])\n\n  return(\n    <Navbar style={{ position: 'absolute', left: 0, top: 0, width: '100vw', background: 'rgba(0, 0, 0, 0.3)' }}>\n      <Container>\n        {loc && <Navbar.Collapse>\n          <Nav className=\"me-auto\">\n            <Button style={{ color: '#fff', borderColor: '#fff' }} className=\"btn btn-sm\" variant=\"outline-secondary\" onClick={() => window.location.href = '/'}>\n              <i className=\"bi bi-house\"></i>\n            </Button>\n            <span style={{ width: '10px' }}></span>\n            <Button style={{ color: '#fff', borderColor: '#fff' }} className=\"btn btn-sm\" variant=\"outline-secondary\" onClick={() => window.history.back()}>\n              <i className=\"bi bi-chevron-compact-left\"></i>\n            </Button>\n          </Nav>\n        </Navbar.Collapse>}\n\n        <Navbar.Brand style={{ color: '#fff', margin: '0px 5px' }}>{title}</Navbar.Brand>\n\n        <Navbar.Collapse>\n          <Nav className=\"me-auto\"></Nav>\n          <Nav>\n            <NavDropdown title={<span style={{ color: '#fff' }}><i className=\"bi bi-translate\"></i></span>} drop={'start'}>\n              <NavDropdown.Item onClick={() => i18n.changeLanguage('ja')}>日本語</NavDropdown.Item>\n              <NavDropdown.Item onClick={() => i18n.changeLanguage('en')}>English</NavDropdown.Item>\n            </NavDropdown>\n\n            <NavDropdown title={<span style={{ color: '#fff' }}><i className=\"bi bi-person-circle\"></i></span>} drop={'start'}>\n              <p style={{ textAlign: 'center', marginBottom: '5px' }}>{user?.displayName}</p>\n              {\n                user\n                  ? <NavDropdown.Item style={{ borderTop: '1px solid #ccc' }} onClick={handleLogout}><i className='bi bi-box-arrow-right' /> {t(\"Header.User.Sign out\")}</NavDropdown.Item>\n                  : <NavDropdown.Item style={{ borderTop: '1px solid #ccc' }} onClick={handleLogin}><i className='bi bi-box-arrow-in-right' /> {t(\"Header.User.Sign in\")}</NavDropdown.Item>\n              }\n              {loc && <NavDropdown.Item style={{ borderTop: '1px solid #ccc' }} onClick={navigateToMyGraffitis}><i className='bi bi-images' /> {t(\"Header.User.Check my graffiti\")}</NavDropdown.Item>}\n            </NavDropdown>\n\n            <NavDropdown\n              title={\n                <span style={{ color: notifications && Object.keys(notifications).length ? 'yellow' : '#fff', fontWeight: notifications && Object.keys(notifications).length ? 'bold' : 'normal' }}>\n                  <i className=\"bi bi-bell\"></i>{notifications && Object.keys(notifications).length}\n                </span>\n              }\n              drop={'start'}\n            >\n              <div style={{ padding: '0px 10px' }}>\n                <i className=\"bi bi-bell\" />\n                <Button variant=\"outline-secondary\" size=\"sm\" style={{ padding: '0px 5px', margin: '0px 0px 5px 10px', border: '1px solid #ccc', color: '#aaa', float: 'right' }} onClick={clearNotifications}>{t(\"Header.Notifications.Clear\")}</Button>\n              </div>\n              {\n                notifications && Object.keys(notifications).map(nid => (\n                  <NavDropdown.Item\n                    style={{ width: '300px', padding: 0, borderTop: '1px solid #ccc' }}\n                    key={nid}\n                    disabled={!loc || loc !== notifications[nid].loc}\n                    onClick={() => navigateToGraffitiFromNotification(loc, nid)}\n                  >\n                    <Row style={{ width: '100%', margin: 0, padding: '5px 0px' }}>\n                      <Col xs={1}>\n                        <div style={{ display: 'flex' }}>\n                          {notifications[nid].type === 0 && <i style={{ color: 'orange' }} className='bi bi-brush' />}\n                          {notifications[nid].type === 1 && <i style={{ color: 'red', paddingTop: '12px' }} className='bi bi-heart' />}\n                        </div>\n                      </Col>\n                      <Col xs={11}>\n                        <small style={{ margin: 0, whiteSpace: 'normal' }}>\n                          {' '}\n                          {\n                            notifications[nid].username && (\n                              i18n.language === \"ja\"\n                                ? notifications[nid].username\n                                : notifications[nid].username?.replace(\"と他の\", \" and other \")?.split(\"\")?.reverse()?.join(\"\")?.replace(\"人\", \"sresu \")?.split(\"\")?.reverse()?.join(\"\")\n                            )\n                              + t(\"Header.Notifications.\" + notificationMap[notifications[nid].type])\n                          }\n                        </small>\n                        <br />\n                        <small style={{ color: '#aaa' }}>{loc && loc === notifications[nid].loc ? t(\"Header.Notifications.Click to check\") : t(\"Header.Notifications.Check in AR\")}</small>\n                      </Col>\n                    </Row>\n                  </NavDropdown.Item>\n                ))\n              }\n            </NavDropdown>\n          </Nav>\n        </Navbar.Collapse>\n      </Container>\n    </Navbar>\n  )\n}\n\nexport default Header;","import { Router } from '@reach/router';\nimport './App.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'react-bootstrap-range-slider/dist/react-bootstrap-range-slider.css';\nimport Home from './Home';\nimport Graffitis from \"./Graffitis\";\nimport { useAuth, useUser, login } from './auth';\nimport Header from './Header';\nimport { Button } from 'react-bootstrap';\nimport { useEffect } from 'react';\nimport { useTranslation } from \"react-i18next\";\n\nconst Auth = ({ children }) => {\n  const isLoading = useAuth();\n\n  return isLoading ? <p>Loading...</p> : children;\n};\n\nfunction App() {\n  const { t } = useTranslation();\n  const user = useUser();\n\n  const handleLogin = () => {\n    login().catch((error) => console.error(error));\n  };\n\n  useEffect(() => {\n    window.addEventListener('popstate', (event) => {\n      navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n        .then(stream => {\n          console.log(\"Camera on\")\n        })\n        .catch(err => {\n          console.error(err)\n        });\n    });\n  })\n\n  return (\n    <div className=\"App\">\n      <Auth>\n        <div>\n          {\n            user\n              ? (\n                <div>\n                  <Header />\n                  <Router>\n                    <Home path=\"/\" />\n                    <Graffitis path=\"/:loc\" />\n                  </Router>\n                </div>\n              )\n              : (\n                <div>\n                  <Header />\n                  <Button style={{ marginTop: '45vh' }} onClick={handleLogin}>{t('App.Sign in with Google')}</Button>\n                </div>\n              )\n          }\n        </div>\n      </Auth>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { useState, useEffect } from 'react';\nimport { useRecoilValue } from 'recoil';\nimport { isRemoteState, currentLocState, currentImgIdState, currentImgSrcState, currentImgAngleState, currentImgSizeState } from './atoms.js';\nimport { getDatabase, ref, get } from \"firebase/database\";\n\nfunction getWindowDimensions() {\n  const { innerWidth: width, innerHeight: height } = window;\n  return {\n    width,\n    height\n  };\n}\n\nfunction Scene() {\n  const isRemote = useRecoilValue(isRemoteState);\n  const currentLoc = useRecoilValue(currentLocState);\n  const currentImgSrc = useRecoilValue(currentImgSrcState);\n  const currentImgId = useRecoilValue(currentImgIdState);\n  const currentImgAngle = useRecoilValue(currentImgAngleState);\n  const currentImgSize = useRecoilValue(currentImgSizeState);\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\n  const [imgSrcs, setImgSrcs] = useState({});\n  const [position, setPosition] = useState(\"0.3 1.5 -10\");\n  const [rotation, setRotation] = useState(\"0 0 0\");\n\n  useEffect(() => {\n    setWindowDimensions(getWindowDimensions());\n\n    const db = getDatabase();\n    get(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_urls/' + currentLoc)).then(snap => {\n      if(snap.exists()){\n        setImgSrcs(snap.val())\n      }\n    }).catch(err => console.error(err));\n    setPosition(`-0.3 ${1.5 - Math.round(Math.cos(currentImgAngle*Math.PI/180) * 50 * 100) / 100} ${(-1)*Math.round(Math.sin(currentImgAngle*Math.PI/180) * 50 * 100) / 100}`);\n    setRotation(`${currentImgAngle-90} 0 0`);\n  }, [currentLoc]);\n\n  useEffect(() => {\n    setPosition(`-0.3 ${1.5 - Math.round(Math.cos(currentImgAngle*Math.PI/180) * 50 * 100) / 100} ${(-1)*Math.round(Math.sin(currentImgAngle*Math.PI/180) * 50 * 100) / 100}`);\n    setRotation(`${currentImgAngle-90} 0 0`);\n  }, [currentImgAngle])\n\n  return (\n    <a-scene\n      id=\"a-scene\"\n      vr-mode-ui=\"enabled: false;\"\n      renderer=\"logarithmicDepthBuffer: true;\"\n      arjs=\"trackingMethod: best; sourceType: webcam;debugUIEnabled: false;\"\n    >\n      <a-assets>\n        {imgSrcs && Object.keys(imgSrcs).map(imgId => <img key={imgId} id={imgId} src={imgSrcs[imgId]} crossOrigin=\"anonymous\" alt={\"graffiti \" + imgId} />)}\n      </a-assets>\n      {currentImgSrc && <a-image\n        src={'#'+currentImgId}\n        width={currentImgSize ? windowDimensions.width / (8 * windowDimensions.width / 414) : 52}\n        height={currentImgSize ? currentImgSize.height * windowDimensions.width / currentImgSize.width / (12.5 * windowDimensions.height / 617) : 40}\n        position={position}\n        rotation={rotation}>\n      </a-image>}\n      \n      {/* <a-entity camera></a-entity> */}\n    </a-scene>\n  )\n}\n\nexport default Scene;","import { useState, useEffect } from 'react';\nimport { useRecoilValue } from 'recoil';\nimport { isRemoteState, currentLocState, currentImgIdState, currentImgSrcState, currentImgAngleState, currentImgSizeState } from './atoms.js';\nimport { getDatabase, ref, get } from \"firebase/database\";\n\nfunction getWindowDimensions() {\n  const { innerWidth: width, innerHeight: height } = window;\n  return {\n    width,\n    height\n  };\n}\n\nfunction RemoteScene() {\n  const isRemote = useRecoilValue(isRemoteState);\n  const currentLoc = useRecoilValue(currentLocState);\n  const currentImgSrc = useRecoilValue(currentImgSrcState);\n  const currentImgId = useRecoilValue(currentImgIdState);\n  const currentImgAngle = useRecoilValue(currentImgAngleState);\n  const currentImgSize = useRecoilValue(currentImgSizeState);\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\n  const [imgSrcs, setImgSrcs] = useState({});\n  const [position, setPosition] = useState(\"0.3 1.5 -10\");\n  const [rotation, setRotation] = useState(\"0 0 0\");\n\n  useEffect(() => {\n    setWindowDimensions(getWindowDimensions());\n\n    const db = getDatabase();\n    get(ref(db, (isRemote ? \"remote/\" : \"\") + 'img_urls/' + currentLoc)).then(snap => {\n      if(snap.exists()){\n        setImgSrcs(snap.val())\n      }\n    }).catch(err => console.error(err));\n    setPosition(`-0.3 ${1.5 - Math.round(Math.cos(currentImgAngle*Math.PI/180) * 50 * 100) / 100} ${(-1)*Math.round(Math.sin(currentImgAngle*Math.PI/180) * 50 * 100) / 100}`);\n    setRotation(`${currentImgAngle-90} 0 0`);\n  }, [currentLoc]);\n\n  useEffect(() => {\n    setPosition(`-0.3 ${1.5 - Math.round(Math.cos(currentImgAngle*Math.PI/180) * 50 * 100) / 100} ${(-1)*Math.round(Math.sin(currentImgAngle*Math.PI/180) * 50 * 100) / 100}`);\n    setRotation(`${currentImgAngle-90} 0 0`);\n  }, [currentImgAngle])\n\n  return (\n    <div>\n      {/* <a-assets>\n        {imgSrcs && Object.keys(imgSrcs).map(imgId => <img key={imgId} id={imgId} src={imgSrcs[imgId]} crossOrigin=\"anonymous\" alt={\"graffiti \" + imgId} />)}\n      </a-assets>\n      {currentImgSrc && <a-image\n        src={'#'+currentImgId}\n        width={currentImgSize ? windowDimensions.width / (8 * windowDimensions.width / 414) : 52}\n        height={currentImgSize ? currentImgSize.height * windowDimensions.width / currentImgSize.width / (12.5 * windowDimensions.height / 617) : 40}\n        position={position}\n        rotation={rotation}>\n      </a-image>} */}\n\n      <img src={`/img/loc/${currentLoc}.jpeg`} alt=\"Background\" width={windowDimensions.width} height={windowDimensions.height} style={{ position: \"absolute\", top: 0, left: 0, zIndex: -1 }} />\n\n      {\n        currentImgSrc && <img src={currentImgSrc} width={windowDimensions.width} height={windowDimensions.height} alt={\"Graffiti #\" + currentImgId} />\n      }\n      \n      {/* <a-entity camera></a-entity> */}\n    </div>\n  )\n}\n\nexport default RemoteScene;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { initializeApp } from 'firebase/app';\nimport Scene from './Scene';\nimport RemoteScene from './RemoteScene';\nimport { useRecoilValue } from 'recoil';\nimport { isRemoteState, currentLocState } from './atoms.js';\nimport { RecoilRoot } from \"recoil\";\nimport \"bootstrap-icons/font/bootstrap-icons.css\";\nimport { useUser } from './auth';\nimport i18n from \"i18next\";\nimport { initReactI18next } from \"react-i18next\";\nimport Cache from 'i18next-localstorage-cache';\nimport detector from \"i18next-browser-languagedetector\";\nimport en from './locales/en.json';\nimport ja from './locales/ja.json';\n\ninitializeApp({\n  apiKey: \"AIzaSyAA4zXM0wRBrL1l65NHg_8mQcjg75ew9RQ\",\n  authDomain: \"campus-coloring.firebaseapp.com\",\n  databaseURL: \"https://campus-coloring.firebaseio.com\",\n  projectId: \"campus-coloring\",\n  storageBucket: \"campus-coloring.appspot.com\",\n  messagingSenderId: \"45926036058\",\n  appId: \"1:45926036058:web:a9271137ac86762843de63\",\n  measurementId: \"G-WPPW3TX4QG\",\n});\n\ni18n\n  .use(detector)\n  .use(initReactI18next) // passes i18n down to react-i18next\n  .use(Cache)\n  .init({\n    // the translations\n    // (tip move them in a JSON file and import them,\n    // or even better, manage them via a UI: https://react.i18next.com/guides/multiple-translation-files#manage-your-translations-with-a-management-gui)\n    resources: {\n      en: {\n        translation: en\n      },\n      ja: {\n        translation: ja\n      }\n    },\n    fallbackLng: \"ja\",\n    interpolation: {\n      escapeValue: false // react already safes from xss => https://www.i18next.com/translation-function/interpolation#unescape\n    }\n  });\n\nconst Root = () => {\n  const currentLoc = useRecoilValue(currentLocState);\n  const isRemote = useRecoilValue(isRemoteState);\n  const user = useUser();\n\n  return (\n    <div style={{ width: \"100%\", height: \"100%\" }}>\n      {user && currentLoc && (isRemote ? <RemoteScene /> : <Scene />)}\n      <App />\n    </div>\n  );\n}\n\nReactDOM.render(<RecoilRoot><Root /></RecoilRoot>, document.getElementById(\"root\"));\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 701;"],"sourceRoot":""}