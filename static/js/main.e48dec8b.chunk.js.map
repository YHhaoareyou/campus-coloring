{"version":3,"sources":["ImageSwitch.js","LikeButton.js","Footer.js","Canvas.js","App.js","Nft.js","img/hiro-marker.png","Scene.js","index.js"],"names":["ImageSwitchWrapper","styled","Grid","ImageSwitch","switchToPrev","switchToNext","Column","width","Button","icon","onClick","circular","LikeButton","state","likes","props","image","isClicked","like","location","db","ref","child","id","toString","set","setState","prevState","prevProps","this","color","style","marginTop","padding","disabled","Icon","name","Label","top","floating","React","Component","FooterWrapper","Footer","openCanvas","Segment","description","Canvas","storage","bkImg","resetCanvas","closeCanvas","console","log","height","onSave","blob","imageName","username","isPublic","prompt","window","confirm","Image","src","uploadTimestamp","Date","now","put","then","snapshot","getDownloadURL","imageUrl","snap","timestamp","user","is_public","alert","catch","error","render","canvas","triggerSave","setColor","setLineWidth","zIndex","margin","backgroundColor","border","background","type","onChange","e","target","value","placeholder","min","max","paddingTop","Layout","InnerLayout","App","isCanvasOpen","isEditMode","currentImg","imagesInfo","length","signIn","auth","signInWithRedirect","firebase","GoogleAuthProvider","signOut","switchToPrevImage","setDisplayImageIndex","prevIndex","indexOf","switchToNextImage","nextIndex","currentLocation","imgUrls","openCanvasWithImg","Nft","entityRef","createRef","markerhandler","url","smooth","smoothCount","smoothTolerance","smoothThreshold","data-location","images","map","img","i","displayImageIndex","position","rotation","Scene","locationNames","currentImages","imageUrlsById","dbData","image_urls","locationData","locations","Object","keys","setImages","setImagesInfo","setLocation","loc","AFRAME","registerComponent","init","el","sceneEl","addEventListener","dataset","once","val","push","components","isImagesLoaded","isLocationsLoaded","vr-mode-ui","renderer","embedded","arjs","hiroMarker","alt","crossOrigin","camera","firebaseApp","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","database","Root","index","onAuthStateChanged","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.e48dec8b.chunk.js","sourcesContent":["import { Button, Grid } from \"semantic-ui-react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst ImageSwitchWrapper = styled(Grid)`\r\n  position: absolute;\r\n  left: 0;\r\n  top: 45%;\r\n  width: 95%;\r\n  height: 5%;\r\n`;\r\n\r\nconst ImageSwitch = ({ switchToPrev, switchToNext }) => (\r\n  <ImageSwitchWrapper>\r\n    <Grid.Column width={1}>\r\n      <Button icon=\"angle left\" onClick={switchToPrev} circular />\r\n    </Grid.Column>\r\n    <Grid.Column width={13}></Grid.Column>\r\n    <Grid.Column width={1}>\r\n      <Button icon=\"angle right\" onClick={switchToNext} circular />\r\n    </Grid.Column>\r\n  </ImageSwitchWrapper>\r\n);\r\n\r\nexport default ImageSwitch;\r\n","import React from \"react\";\r\nimport { Button, Icon, Label } from \"semantic-ui-react\";\r\n\r\nclass LikeButton extends React.Component {\r\n  state = {\r\n    likes: this.props.image.likes || 0,\r\n    isClicked: false,\r\n  };\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (\r\n      prevProps.image &&\r\n      this.props.image &&\r\n      prevProps.image !== this.props.image\r\n    ) {\r\n      this.setState({ likes: this.props.image.likes || 0, isClicked: false });\r\n    }\r\n  }\r\n\r\n  like = () => {\r\n    const { location, image, db } = this.props;\r\n    db.ref(\"locations/\" + location)\r\n      .child(image.id.toString())\r\n      .child(\"likes\")\r\n      .set(image.likes ? image.likes + 1 : 1);\r\n    this.setState((prevState) => ({\r\n      ...prevState,\r\n      likes: prevState.likes + 1,\r\n      isClicked: true,\r\n    }));\r\n  };\r\n\r\n  render() {\r\n    const { likes, isClicked } = this.state;\r\n    return (\r\n      <Button\r\n        color=\"red\"\r\n        style={{ marginTop: \"1.5rem\", padding: \"0.8rem 0.3rem 0.6rem 1rem\" }}\r\n        onClick={this.like}\r\n        disabled={isClicked}\r\n      >\r\n        <Icon name=\"heart\" />\r\n        <Label style={{ top: \"1rem\" }} floating>\r\n          {likes}\r\n        </Label>\r\n      </Button>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LikeButton;\r\n","import { Button, Grid, Segment } from \"semantic-ui-react\";\r\nimport styled from \"styled-components\";\r\nimport LikeButton from \"./LikeButton\";\r\n\r\nconst FooterWrapper = styled(Grid)`\r\n  position: absolute;\r\n  left: 0;\r\n  bottom: 0%;\r\n  width: 100%;\r\n  height: 15%;\r\n`;\r\n\r\nconst Footer = ({ location, image, openCanvas, db }) => (\r\n  <FooterWrapper>\r\n    <Grid.Column width={8} style={{ padding: \"1rem\" }}>\r\n      <Segment>\r\n        <h4>{image.name}</h4>\r\n        <p>{image.description}</p>\r\n      </Segment>\r\n    </Grid.Column>\r\n    <Grid.Column width={2} style={{ padding: \"1rem 0px\" }}>\r\n      <LikeButton location={location} image={image} db={db} />\r\n    </Grid.Column>\r\n    <Grid.Column width={6} style={{ padding: \"1rem\" }}>\r\n      <Button\r\n        color=\"green\"\r\n        onClick={openCanvas}\r\n        style={{ padding: \"1rem 0.2rem\", width: \"100%\" }}\r\n      >\r\n        Create new\r\n      </Button>\r\n      <Button\r\n        color=\"orange\"\r\n        onClick={openCanvas}\r\n        style={{ padding: \"1rem 0.2rem\", width: \"100%\" }}\r\n      >\r\n        Paint on this\r\n      </Button>\r\n    </Grid.Column>\r\n  </FooterWrapper>\r\n);\r\n\r\nexport default Footer;\r\n","import { Button } from \"semantic-ui-react\";\r\nimport { ReactPainter } from \"react-painter\";\r\n\r\nconst Canvas = ({ db, storage, location, bkImg, resetCanvas, closeCanvas }) => {\r\n  console.log(bkImg);\r\n  console.log(bkImg);\r\n  console.log(bkImg);\r\n  const saveCanvas = (blob) => {\r\n    var imageName, description, username, isPublic;\r\n    do {\r\n      username = prompt(\"What's your name? Any nickname is fine!\");\r\n    } while (!username);\r\n    do {\r\n      imageName = prompt(\"Please name your painting:\");\r\n    } while (!imageName);\r\n    description = prompt(\"Please write something about this painting:\");\r\n    isPublic = window.confirm(\r\n      \"Do you allow other users create paintings basing on this one?\"\r\n    );\r\n    var image = new Image();\r\n    image.src = blob;\r\n    const uploadTimestamp = Date.now();\r\n    storage\r\n      .ref()\r\n      .child(\"images/\" + imageName)\r\n      .put(blob)\r\n      .then((snapshot) => {\r\n        return snapshot.ref.getDownloadURL();\r\n      })\r\n      .then((imageUrl) => {\r\n        db.ref(\"image_urls\")\r\n          .child(uploadTimestamp)\r\n          .set(imageUrl)\r\n          .then((snap) => {\r\n            db.ref(\"locations\")\r\n              .child(location + \"/\" + uploadTimestamp)\r\n              .set({\r\n                name: imageName,\r\n                description: description,\r\n                timestamp: uploadTimestamp,\r\n                user: username,\r\n                is_public: isPublic,\r\n              })\r\n              .then(function (snap) {\r\n                alert(\"Uploaded! Refresh the page to see your materpiece!\");\r\n                closeCanvas();\r\n              })\r\n              .catch((error) => {\r\n                alert(error);\r\n              });\r\n          });\r\n      });\r\n  };\r\n\r\n  return (\r\n    <ReactPainter\r\n      width={300}\r\n      height={500}\r\n      onSave={saveCanvas}\r\n      image={bkImg}\r\n      render={({ canvas, triggerSave, setColor, setLineWidth }) => {\r\n        return (\r\n          <div style={{ zIndex: \"1000\" }}>\r\n            <h2 style={{ margin: \"0px\" }}>{location || \"none\"}</h2>\r\n            <div\r\n              style={{\r\n                backgroundColor: \"rgba(0, 0, 0, 0)\",\r\n                border: \"5px solid #666\",\r\n              }}\r\n            >\r\n              {canvas}\r\n            </div>\r\n            <div style={{ padding: \"1rem\", background: \"#ccc\" }}>\r\n              <div>\r\n                Color{\" \"}\r\n                <input\r\n                  type=\"color\"\r\n                  onChange={(e) => setColor(e.target.value)}\r\n                  style={{ width: \"30%\" }}\r\n                />{\" \"}\r\n                Width{\" \"}\r\n                <input\r\n                  type=\"number\"\r\n                  placeholder=\"5\"\r\n                  min=\"1\"\r\n                  max=\"20\"\r\n                  onChange={(e) => setLineWidth(e.target.value)}\r\n                  style={{ width: \"30%\" }}\r\n                />\r\n              </div>\r\n              <div style={{ paddingTop: \"1rem\" }}>\r\n                <Button color=\"red\" icon=\"close\" onClick={closeCanvas} />\r\n                <Button color=\"orange\" onClick={resetCanvas}>\r\n                  Reset\r\n                </Button>\r\n                <Button color=\"green\" onClick={triggerSave}>\r\n                  Save!!\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        );\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Canvas;\r\n","import React from \"react\";\r\nimport \"./App.css\";\r\nimport \"semantic-ui-css/semantic.min.css\";\r\nimport styled from \"styled-components\";\r\nimport firebase from \"firebase/app\";\r\nimport ImageSwitch from \"./ImageSwitch\";\r\nimport Footer from \"./Footer\";\r\nimport Canvas from \"./Canvas\";\r\n\r\nconst Layout = styled(\"div\")`\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 90%;\r\n`;\r\n\r\nconst InnerLayout = styled(\"div\")`\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n`;\r\n\r\nclass App extends React.Component {\r\n  state = {\r\n    isCanvasOpen: false,\r\n    isEditMode: false,\r\n    currentImg:\r\n      this.props.imagesInfo &&\r\n      this.props.imagesInfo.length &&\r\n      this.props.imagesInfo[0],\r\n  };\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (\r\n      this.props.imagesInfo &&\r\n      prevProps.imagesInfo !== this.props.imagesInfo\r\n    ) {\r\n      if (this.props.imagesInfo.length > 0) {\r\n        this.setState({ currentImg: this.props.imagesInfo[0] });\r\n      } else {\r\n        this.setState({ currentImg: null });\r\n      }\r\n    }\r\n  }\r\n\r\n  signIn = () => {\r\n    try {\r\n      this.props.auth.signInWithRedirect(\r\n        new firebase.auth.GoogleAuthProvider()\r\n      );\r\n    } catch (e) {\r\n      alert(e);\r\n    }\r\n  };\r\n\r\n  signOut = () => {\r\n    try {\r\n      this.props.auth.signOut();\r\n    } catch (e) {\r\n      alert(e);\r\n    }\r\n  };\r\n\r\n  switchToPrevImage = () => {\r\n    const { imagesInfo, setDisplayImageIndex } = this.props;\r\n    const { currentImg } = this.state;\r\n    const prevIndex =\r\n      imagesInfo.indexOf(currentImg) === 0\r\n        ? imagesInfo.length - 1\r\n        : imagesInfo.indexOf(currentImg) - 1;\r\n    this.setState({\r\n      currentImg: imagesInfo[prevIndex],\r\n    });\r\n    setDisplayImageIndex(prevIndex);\r\n  };\r\n\r\n  switchToNextImage = () => {\r\n    const { imagesInfo, setDisplayImageIndex } = this.props;\r\n    const { currentImg } = this.state;\r\n    const nextIndex =\r\n      imagesInfo.indexOf(currentImg) + 1 === imagesInfo.length\r\n        ? 0\r\n        : imagesInfo.indexOf(currentImg) + 1;\r\n    this.setState({\r\n      currentImg: imagesInfo[nextIndex],\r\n    });\r\n    setDisplayImageIndex(nextIndex);\r\n  };\r\n\r\n  resetCanvas = () => {\r\n    this.setState({ isCanvasOpen: false }, () =>\r\n      this.setState({ isCanvasOpen: true })\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { currentLocation, db, storage, imgUrls } = this.props;\r\n    const { isCanvasOpen, currentImg, isEditMode } = this.state;\r\n    return (\r\n      <Layout>\r\n        <InnerLayout>\r\n          {isCanvasOpen && (\r\n            <Canvas\r\n              location={currentLocation}\r\n              bkImg={\r\n                \"https://firebasestorage.googleapis.com/v0/b/campus-coloring.appspot.com/o/images%2FFSE?alt=media&token=b71ce295-ff89-4623-9fe2-25feb18faca6\"\r\n              }\r\n              isEditMode={isEditMode}\r\n              db={db}\r\n              storage={storage}\r\n              resetCanvas={this.resetCanvas}\r\n              closeCanvas={() =>\r\n                this.setState({ isCanvasOpen: false, isEditMode: false })\r\n              }\r\n            />\r\n          )}\r\n\r\n          {currentImg && !isCanvasOpen && (\r\n            <ImageSwitch\r\n              switchToPrev={this.switchToPrevImage}\r\n              switchToNext={this.switchToNextImage}\r\n            />\r\n          )}\r\n\r\n          {currentImg && !isCanvasOpen && (\r\n            <Footer\r\n              location={currentLocation}\r\n              image={currentImg}\r\n              openCanvas={() =>\r\n                this.setState({ isCanvasOpen: true, isEditMode: false })\r\n              }\r\n              openCanvasWithImg={() =>\r\n                this.setState({ isCanvasOpen: true, isEditMode: true })\r\n              }\r\n              db={db}\r\n            />\r\n          )}\r\n        </InnerLayout>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\r\n\r\nclass Nft extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.entityRef = React.createRef();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <a-nft\r\n        markerhandler\r\n        type=\"nft\"\r\n        url={\r\n          \"https://yhhaoareyou.github.io/campus-coloring/descriptors/\" +\r\n          this.props.location\r\n        }\r\n        smooth=\"true\"\r\n        smoothCount=\"10\"\r\n        smoothTolerance=\".01\"\r\n        smoothThreshold=\"5\"\r\n        id=\"a-nft\"\r\n        data-location={this.props.location}\r\n      >\r\n        {this.props.images.map((img, i) => (\r\n          <a-image\r\n            src={\"#\" + img.id}\r\n            width={i === this.props.displayImageIndex ? 375 * 0.5 : 0}\r\n            height={i === this.props.displayImageIndex ? 500 * 0.5 : 0}\r\n            position=\"35 0 0\"\r\n            rotation=\"-90 0 0\"\r\n            key={img.id}\r\n          ></a-image>\r\n        ))}\r\n      </a-nft>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Nft;\r\n","export default __webpack_public_path__ + \"static/media/hiro-marker.81a8bff1.png\";","import React from \"react\";\r\nimport Nft from \"./Nft\";\r\nimport hiroMarker from \"./img/hiro-marker.png\";\r\nimport \"firebase/database\";\r\nimport \"firebase/storage\";\r\n\r\nclass Scene extends React.Component {\r\n  state = {\r\n    locationNames: [],\r\n    currentLocation: \"\",\r\n    currentImages: [],\r\n    imageUrlsById: {},\r\n  };\r\n\r\n  async componentDidMount() {\r\n    const { db, dbData } = this.props;\r\n    const imageUrlsById = dbData.image_urls;\r\n    const locationData = dbData.locations;\r\n    this.setState({\r\n      imageUrlsById: imageUrlsById,\r\n      locationNames: Object.keys(locationData),\r\n    });\r\n\r\n    const setImages = (images) => {\r\n      this.setState({ currentImages: images });\r\n      this.props.setImagesInfo(images);\r\n    };\r\n    const setLocation = (loc) => {\r\n      this.setState({ currentLocation: loc });\r\n      this.props.setLocation(loc);\r\n    };\r\n\r\n    window.AFRAME.registerComponent(\"markerhandler\", {\r\n      init: function () {\r\n        this.el.sceneEl.addEventListener(\"markerFound\", (e) => {\r\n          const currentLocation = e.target.dataset.location;\r\n          setLocation(currentLocation);\r\n          db.ref(\"locations\")\r\n            .child(currentLocation)\r\n            .once(\"value\", (snap) => {\r\n              var currentImages = [];\r\n              const images = snap.val();\r\n              for (var id in images) {\r\n                currentImages.push({ ...images[id], id: id });\r\n              }\r\n              setImages(currentImages);\r\n            });\r\n        });\r\n\r\n        this.el.sceneEl.addEventListener(\"markerLost\", (e) => setImages([]));\r\n      },\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    delete window.AFRAME.components.markerhandler;\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      locationNames,\r\n      currentLocation,\r\n      currentImages,\r\n      imageUrlsById,\r\n    } = this.state;\r\n    const isImagesLoaded = Object.keys(imageUrlsById).length > 0;\r\n    const isLocationsLoaded = locationNames.length > 0;\r\n    return (\r\n      <a-scene\r\n        id=\"a-scene\"\r\n        vr-mode-ui=\"enabled: false;\"\r\n        renderer=\"logarithmicDepthBuffer: true;\"\r\n        embedded\r\n        arjs=\"trackingMethod: best; sourceType: webcam;debugUIEnabled: false;\"\r\n      >\r\n        {isImagesLoaded && (\r\n          <a-assets>\r\n            <img id=\"hiroMarker\" src={hiroMarker} alt=\"hiroMarker\" />\r\n            {Object.keys(imageUrlsById).map((id) => (\r\n              <img\r\n                key={id}\r\n                id={id}\r\n                src={imageUrlsById[id]}\r\n                alt={id}\r\n                crossOrigin=\"anonymous\"\r\n              />\r\n            ))}\r\n          </a-assets>\r\n        )}\r\n        {isImagesLoaded &&\r\n          isLocationsLoaded &&\r\n          locationNames.map((name) => (\r\n            <Nft\r\n              key={name}\r\n              location={name}\r\n              images={\r\n                currentLocation === name && currentImages.length > 0\r\n                  ? currentImages\r\n                  : []\r\n              }\r\n              displayImageIndex={this.props.displayImageIndex}\r\n            />\r\n          ))}\r\n        <a-entity camera></a-entity>\r\n      </a-scene>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Scene;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport Scene from \"./Scene\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/auth\";\r\n\r\nconst firebaseApp = firebase.initializeApp({\r\n  apiKey: \"AIzaSyAA4zXM0wRBrL1l65NHg_8mQcjg75ew9RQ\",\r\n  authDomain: \"campus-coloring.firebaseapp.com\",\r\n  databaseURL: \"https://campus-coloring.firebaseio.com\",\r\n  projectId: \"campus-coloring\",\r\n  storageBucket: \"campus-coloring.appspot.com\",\r\n  messagingSenderId: \"45926036058\",\r\n  appId: \"1:45926036058:web:a9271137ac86762843de63\",\r\n  measurementId: \"G-WPPW3TX4QG\",\r\n});\r\n\r\nconst auth = firebaseApp.auth();\r\nconst database = firebaseApp.database();\r\nconst storage = firebaseApp.storage();\r\n\r\nclass Root extends React.Component {\r\n  state = {\r\n    imagesInfo: null,\r\n    currentLocation: null,\r\n    user: \"loading\",\r\n    displayImageIndex: 0,\r\n    dbData: null,\r\n  };\r\n\r\n  async componentDidMount() {\r\n    auth.onAuthStateChanged((user) => {\r\n      if (user) {\r\n        this.setState({ user });\r\n      } else {\r\n        this.setState({ user: null });\r\n      }\r\n    });\r\n    const dbData = await database.ref().once(\"value\");\r\n    this.setState({ dbData: dbData.val() });\r\n  }\r\n\r\n  setImagesInfo = (images) => this.setState({ imagesInfo: images });\r\n  setLocation = (loc) => this.setState({ currentLocation: loc });\r\n  setDisplayImageIndex = (index) => this.setState({ displayImageIndex: index });\r\n\r\n  render() {\r\n    return (\r\n      <div style={{ width: \"100%\", height: \"100%\" }}>\r\n        {this.state.dbData && (\r\n          <Scene\r\n            db={database}\r\n            storage={storage}\r\n            dbData={this.state.dbData}\r\n            setImagesInfo={this.setImagesInfo}\r\n            setLocation={this.setLocation}\r\n            displayImageIndex={this.state.displayImageIndex}\r\n          />\r\n        )}\r\n        <App\r\n          imagesInfo={this.state.imagesInfo}\r\n          currentLocation={this.state.currentLocation}\r\n          auth={auth}\r\n          user={this.state.user}\r\n          db={database}\r\n          storage={storage}\r\n          imgUrls={this.state.dbData && this.state.dbData.image_urls}\r\n          setDisplayImageIndex={this.setDisplayImageIndex}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nReactDOM.render(<Root />, document.getElementById(\"root\"));\r\n\r\n// setTimeout(ReactDOM.render(<App />, document.getElementById(\"root\")), 1500);\r\n"],"sourceRoot":""}