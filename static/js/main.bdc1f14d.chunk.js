(this["webpackJsonpcampus-coloring"]=this["webpackJsonpcampus-coloring"]||[]).push([[0],{1151:function(e,t){},1152:function(e,t){},1153:function(e,t){},1154:function(e,t){},1160:function(e,t,n){"use strict";n.r(t);var c,i,a,r,o,s,l,b=n(0),j=n.n(b),d=n(64),u=n.n(d),O=(n(531),n(239)),h=(n(536),n(537),n(538),n(11)),f=n(47),x=n(109),p=n(185),g=n(48),m={garden:{name:"\u4e2d\u5ead",description:"\u30c6\u30b9\u30c8\u7528",range:{minLat:35,maxLat:36,minLong:139,maxLong:140}},51:{name:"51\u53f7\u9928",description:"\u5317\u9580\u5bc4\u308a\u306e\u7a7a\u4e2d\u901a\u8def\u304b\u3089\u306e\u8996\u70b9",range:{minLat:35.7061,maxLat:35.7066,minLong:139.7065,maxLong:139.707}},55:{name:"55\u53f7\u9928\u5916",description:"\u5916\u306e\u5eca\u4e0b\u304b\u3089\u3001\u4e2d\u5ead\u5411\u304d\uff1b\u96e8\u5929OK",range:{minLat:35.7056,maxLat:35.7062,minLong:139.7078,maxLong:139.7083}},"51_60_top":{name:"51\u300160\u53f7\u9928\u306e\u9593",description:"59\u53f7\u9928\u5074\u306e\u7a7a\u4e2d\u901a\u8def\u304b\u3089\u306e\u8996\u70b9",range:{minLat:35.7056,maxLat:35.706,minLong:139.7061,maxLong:139.7065}},"60_61":{name:"60\u300161\u53f7\u9928\u306e\u9593",description:"59\u53f7\u9928\u5074\u306e\u5730\u9762\u901a\u8def\u304b\u3089\u306e\u8996\u70b9\uff1b\u96e8\u5929OK",range:{minLat:35.7056,maxLat:35.706,minLong:139.7057,maxLong:139.7061}}},v=n(2),w=g.a.div(c||(c=Object(f.a)(["\n  position: relative;\n  margin: 0px auto;\n  width: 400px;\n  height: 160px;\n  background-image: url('/img/map.jpeg');\n  background-size: contain;\n"]))),y=g.a.i(i||(i=Object(f.a)(["\n  position: absolute;\n  font-size: 24px;\n"]))),k=(Object(g.a)(y)(a||(a=Object(f.a)(["\ntop: 50px;\nleft: 250px;\n"]))),[{loc:"51",Pin:Object(g.a)(y)(r||(r=Object(f.a)(["\n  top: -10px;\n  left: 170px;\n"])))},{loc:"51_60_top",Pin:Object(g.a)(y)(o||(o=Object(f.a)(["\n  top: 70px;\n  left: 135px;\n"])))},{loc:"60_61",Pin:Object(g.a)(y)(s||(s=Object(f.a)(["\n  top: 70px;\n  left: 105px;\n"])))},{loc:"55",Pin:Object(g.a)(y)(l||(l=Object(f.a)(["\n  top: 50px;\n  left: 310px;\n"])))}]);var C=function(){var e=Object(b.useState)(null),t=Object(h.a)(e,2),n=t[0],c=t[1],i=Object(b.useState)(""),a=Object(h.a)(i,2),r=a[0],o=a[1],s=Object(b.useState)(!1),l=Object(h.a)(s,2),j=l[0],d=l[1],u=function(){navigator.geolocation.getCurrentPosition((function(e){c(e.coords),j&&d(!1)}),(function(e){d(!0)}))};Object(b.useEffect)((function(){u();var e=setInterval(u,5e3);return function(){return clearInterval(e)}}),[]);var f=function(e){return n&&e&&n.latitude>=e.minLat&&n.latitude<=e.maxLat&&n.longitude>=e.minLong&&n.longitude<=e.maxLong};return Object(v.jsxs)("div",{style:{paddingTop:"70px"},children:[Object(v.jsx)("h3",{children:"\u5834\u6240\u3092\u9078\u629e"}),!n&&Object(v.jsxs)("p",{children:[Object(v.jsx)("i",{className:"bi bi-arrow-clockwise"})," \u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u4e2d..."]}),j&&Object(v.jsx)("p",{style:{color:"red"},children:"\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u5931\u6557\u3002\u4f4d\u7f6e\u60c5\u5831\u306e\u53d6\u5f97\u3092\u8a31\u53ef\u3057\u3001\u906e\u853d\u7269\u306e\u306a\u3044\u7a7a\u9593\u306b\u79fb\u52d5\u3057\u3066\u6570\u79d2\u5f85\u3063\u3066\u304f\u3060\u3055\u3044\u3002"}),Object(v.jsx)(w,{children:k.map((function(e){var t=e.loc,n=e.Pin;return Object(v.jsx)(n,{onClick:function(){return o(t)},className:"bi bi-geo-alt-fill",style:{color:f(m[t].range)?"orange":"black"}},t)}))}),Object(v.jsxs)("div",{style:{textAlign:"left",padding:"20px",fontSize:"14px"},children:[Object(v.jsx)("strong",{children:"\u8aac\u660e"}),Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:"\u30d4\u30f3\u3092\u30bf\u30c3\u30c1\u3059\u308b\u3068\u3001\u305d\u3053\u306e\u666f\u8272\u304c\u6620\u3063\u305f\u753b\u50cf\u304c\u8868\u793a\u3055\u308c\u307e\u3059"}),Object(v.jsx)("li",{children:"\u30d4\u30f3\u3055\u308c\u305f\u5834\u6240\u306e\u8fd1\u304f\u306b\u79fb\u52d5\u3059\u308b\u3068\u3001\u30d4\u30f3\u304c\u9ec4\u8272\u306b\u306a\u308a\u3001\u30bf\u30c3\u30c1\u3059\u308b\u3068\u7d75\u304c\u898b\u3048\u307e\u3059"}),Object(v.jsx)("li",{children:"5\u79d2\u3054\u3068\u306b\u4f4d\u7f6e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u307e\u3059"})]}),Object(v.jsx)("strong",{children:"\u5834\u6240\u4e00\u89a7"}),Object(v.jsxs)("ul",{children:[Object(v.jsxs)("li",{children:[Object(v.jsx)("b",{children:"51\u53f7\u9928"}),"\uff1a\u5317\u9580\u5bc4\u308a\u306e\u7a7a\u4e2d\u901a\u8def\u304b\u3089\u306e\u8996\u70b9\uff08\u96e8\u5929\xd7\uff09"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("b",{children:"55\u53f7\u9928\u5916"}),"\uff1a\u5916\u306e\u5eca\u4e0b\u304b\u3089\u3001\u4e2d\u5ead\u5411\u304d"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("b",{children:"51\u300160\u53f7\u9928\u306e\u9593"}),"\uff1a59\u53f7\u9928\u5074\u306e\u5730\u9762\u901a\u8def\u304b\u3089\u306e\u8996\u70b9\uff08\u96e8\u5929\xd7\uff09"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("b",{children:"60\u300161\u53f7\u9928\u306e\u9593"}),"\uff1a59\u53f7\u9928\u5074\u306e\u7a7a\u4e2d\u901a\u8def\u304b\u3089\u306e\u8996\u70b9"]})]})]}),Object(v.jsxs)(p.a,{centered:!0,show:""!==r,onHide:function(){return o("")},children:[Object(v.jsx)(p.a.Header,{closeButton:!0,children:Object(v.jsx)(p.a.Title,{children:r&&m[r].name})}),Object(v.jsxs)(p.a.Body,{style:{textAlign:"center"},children:[Object(v.jsx)("p",{children:r&&m[r].description}),Object(v.jsx)("img",{src:"/img/loc/".concat(r,".jpeg"),width:"80%",alt:"View of the location"}),r&&(f(m[r].range)||"garden"===r)?Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:"\u2191\u306e\u666f\u8272\u306b\u30ab\u30e1\u30e9\u3092\u5411\u3051\u3066\u304f\u3060\u3055\u3044"}),Object(v.jsx)(O.a,{to:"/"+r,children:Object(v.jsx)(x.a,{variant:"outline-primary",children:"\u7d75\u3092\u89b3\u308b"})})]}):Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:"\u3053\u306e\u5834\u6240\u306b\u79fb\u52d5\u3057\u3001\u6570\u79d2\u5f85\u3064\u3068\u7d75\u304c\u898b\u3048\u308b\u3088"}),Object(v.jsx)("p",{children:"\u79fb\u52d5\u3057\u3066\u3082\u30c0\u30e1\u3067\u3057\u305f\u3089\u3001\u753b\u9762\u3092\u66f4\u65b0\u3057\u3066\u304f\u3060\u3055\u3044"})]})]})]})]})};var N,S,L,_=function(){return Object(v.jsx)("div",{children:Object(v.jsx)(C,{})})},I=n(4),T=n(6),P=g.a.div(N||(N=Object(f.a)(["\n  position: absolute;\n  top: 50vh;\n  left: 0;\n"]))),z=g.a.div(S||(S=Object(f.a)(["\n  position: absolute;\n  top: 50vh;\n  right: 0;\n"]))),E=Object(g.a)(x.a)(L||(L=Object(f.a)(["\n  background: rgba(255, 255, 255, 0.3);\n  color: rgba(200, 200, 200);\n  border: none;\n  font-size: 36px;\n  padding: 0px;\n"])));var M,A,B,R=function(e){var t=e.switchPrev,n=e.switchNext;return Object(v.jsxs)(j.a.Fragment,{children:[Object(v.jsx)(P,{children:Object(v.jsx)(E,{variant:"light",onClick:t,children:Object(v.jsx)("i",{className:"bi bi-chevron-compact-left"})})}),Object(v.jsx)(z,{children:Object(v.jsx)(E,{variant:"light",onClick:n,children:Object(v.jsx)("i",{className:"bi bi-chevron-compact-right"})})})]})},U=n(1167),D=n(1175),F=n(1168),H=n(33),W=Object(H.b)({key:"currentLocState",default:""}),K=Object(H.b)({key:"currentImgIdState",default:""}),V=Object(H.b)({key:"currentImgSrcState",default:""}),G=Object(H.b)({key:"currentImgAngleState",default:0}),Q=Object(H.b)({key:"currentImgSizeState",default:null}),J=Object(H.b)({key:"userState",default:null,dangerouslyAllowMutability:!0}),X=n(112),q=function(){var e=new X.a,t=Object(X.b)();return Object(X.d)(t,e)},Y=function(){return Object(H.d)(J)},Z=Object(g.a)(U.a)(M||(M=Object(f.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  background-color: transparent;\n  padding-bottom: 10px;\n"]))),$=Object(g.a)(x.a)(A||(A=Object(f.a)(["\n  background: transparent;\n  border: 0.5px solid #fff;\n  border-bottom: none;\n  height: 30px;\n  color: #fff;\n"]))),ee=Object(g.a)(D.a)(B||(B=Object(f.a)(["\n  height: 100px;\n  overflow-y: scroll;\n  background-color: rgba(0, 0, 0, 0.4);\n  color: #fff;\n  border: 0.5px solid #fff;\n"])));var te,ne,ce,ie=function(e){var t=e.imgInfo,n=e.openCanvas,c=(e.canvasVisibility,e.likeTrigger),i=Y(),a=Object(b.useState)(!1),r=Object(h.a)(a,2),o=r[0],s=r[1],l=Object(b.useState)(t.likes?Object.keys(t.likes).length:0),j=Object(h.a)(l,2),d=j[0],u=j[1],O=Object(b.useState)(t.likes&&Object.keys(t.likes).includes(i.uid)),f=Object(h.a)(O,2),g=f[0],m=f[1];return Object(b.useEffect)((function(){u(t.likes?Object.keys(t.likes).length:0),m(t.likes&&Object.keys(t.likes).includes(i.uid))}),[t]),Object(v.jsxs)(Z,{children:[Object(v.jsx)(ee,{children:Object(v.jsxs)(D.a.Body,{style:{padding:0},children:[Object(v.jsx)(D.a.Title,{as:"h6",style:{height:"15px",margin:"5px"},children:t.title}),Object(v.jsx)(D.a.Text,{style:{fontSize:"14px",height:"40px",margin:"5px"},children:t.detail}),Object(v.jsxs)(F.a,{style:{width:"100%",margin:0,height:"30px"},children:[Object(v.jsxs)($,{variant:"light",size:"sm",onClick:function(){window.location.href=window.location.origin+window.location.pathname+"?mode=user&uid="+t.creator_id},style:{borderLeft:"none"},children:[Object(v.jsx)("i",{className:"bi bi-person"})," ","\u30e6\u30fc\u30b6"]}),(null===t||void 0===t?void 0:t.prev_img_ids)&&Object(v.jsxs)($,{variant:"light",size:"sm",onClick:function(){window.location.href=window.location.origin+window.location.pathname+"?mode=base&bid="+t.id},style:{marginBottom:0},children:[Object(v.jsx)("i",{className:"bi bi-collection"})," ","\u524d\u4f5c\u3078"]}),Object(v.jsxs)($,{variant:"light",size:"sm",onClick:function(){c(),u(g?d-1:d+1),m(!g)},children:[Object(v.jsx)("i",{className:g?"bi bi-heart-fill":"bi bi-heart"})," ",d]}),Object(v.jsxs)($,{variant:"light",size:"sm",onClick:function(){return s(!0)},style:{borderRight:"none"},children:[Object(v.jsx)("i",{className:"bi bi-pencil"})," ","\u63cf\u3053\u3046"]})]})]})}),Object(v.jsxs)(p.a,{centered:!0,show:o,onHide:function(){return s(!1)},children:[Object(v.jsx)(p.a.Header,{closeButton:!0,children:Object(v.jsx)(p.a.Title,{children:"\u3069\u3093\u306a\u7d75\u3092\u63cf\u304d\u305f\u3044\uff1f"})}),Object(v.jsxs)(p.a.Body,{style:{textAlign:"center"},children:[Object(v.jsx)(x.a,{variant:"outline-primary",onClick:function(){n({isNew:!0}),s(!1)},children:"\u65b0\u3057\u304f\u63cf\u3053\u3046"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)(x.a,{variant:"outline-primary",onClick:function(){n({isNew:!1}),s(!1)},children:"\u3053\u308c\u3092\u30d9\u30fc\u30b9\u306b\u3057\u3066\u63cf\u3053\u3046"})]})]})]})},ae=n(27),re=n(186),oe=n(525),se=n(1169),le=n(1170),be=n(1173),je=n(524),de=n(82),ue=n(519),Oe=n.n(ue),he=n(520),fe=Object(g.a)(U.a)(te||(te=Object(f.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100vw;\n  height: 80px;\n  padding: 0px;\n  background-color: transparent;\n"]))),xe=Object(g.a)(x.a)(ne||(ne=Object(f.a)(["\n  margin: 0px 3px;\n  padding: 0px;\n  width: 35px;\n  height: 35px;\n  border-radius: 50%;\n  border: 0.5px solid #fff;\n  background-color: rgba(0, 0, 0, 0.4);\n  color: #fff;\n"]))),pe=Object(g.a)(x.a)(ce||(ce=Object(f.a)(["\n  padding: 3px 0px;\n  border: 0.5px solid #fff;\n  background-color: rgba(0, 0, 0, 0.4);\n  color: #fff;\n"])));function ge(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}function me(e,t){he.fabric.Image.fromURL(e,(function(e){e.scaleToWidth(ge().width),t.add(e.set({left:0,top:0}))}),{crossOrigin:"Anonymous"})}var ve=function(e){var t=e.closeCanvas,n=e.basePrevIds,c=e.isNew,i=e.imgInfos,a=Y(),r=Object(H.d)(W),o=Object(H.d)(K),s=Object(H.d)(V),l=Object(b.useState)(ge()),j=Object(h.a)(l,2),d=j[0],u=j[1],O=Object(b.useRef)(null),f=Object(b.useState)("#000"),x=Object(h.a)(f,2),p=x[0],g=x[1],m=Object(b.useState)(5),w=Object(h.a)(m,2),y=w[0],k=w[1],C=Object(b.useState)(de.Tools.Pencil),N=Object(h.a)(C,2),S=N[0],L=N[1],_=Object(b.useState)(!1),P=Object(h.a)(_,2),z=P[0],E=P[1],M=Object(b.useState)(!1),A=Object(h.a)(M,2),B=A[0],R=A[1],U=Object(b.useState)(0),D=Object(h.a)(U,2),G=D[0],Q=D[1];Object(b.useEffect)((function(){u(ge()),c||me(s,O.current._fc)}),[c,s]),Object(b.useEffect)((function(){window.addEventListener("deviceorientation",(function(e){var t=e.beta;Q(Math.round(100*t)/100)}))}),[]);return Object(v.jsxs)("div",{style:{position:"absolute",zIndex:1e3,left:0,backgroundColor:"rgba(255, 255, 255, 0.5)",borderBottom:"5px solid #aaa"},children:[Object(v.jsx)(de.SketchField,{name:"sketch",className:"canvas-area",ref:O,lineColor:p,lineWidth:y,fillColor:"transparent",width:d.width,height:d.height,forceValue:!0,onChange:function(){var e,t=z,n=null===(e=O.current)||void 0===e?void 0:e.canUndo();t!==n&&E(n)},tool:S,imageFormat:"jpeg"}),Object(v.jsxs)(fe,{children:[Object(v.jsxs)(se.a,{style:{padding:"0px 15px",marginBottom:"10px"},children:[Object(v.jsxs)(le.a,{xs:4,style:{padding:0},children:[Object(v.jsx)(xe,{variant:S===de.Tools.Pencil?"secondary":"light",onClick:function(){return L(de.Tools.Pencil)},children:Object(v.jsx)("i",{className:"bi bi-pencil"})}),Object(v.jsx)(xe,{variant:S===de.Tools.Line?"secondary":"light",onClick:function(){return L(de.Tools.Line)},children:Object(v.jsx)("i",{className:"bi bi-slash-lg"})}),Object(v.jsx)(be.a,{trigger:"click",placement:"top",overlay:function(e){return Object(v.jsx)(oe.a,Object(T.a)(Object(T.a)({},e),{},{style:Object(T.a)(Object(T.a)({},e.style),{},{padding:"10px"}),children:Object(v.jsx)(je.a,{id:"lineColor",color:p,onChange:function(e){return g(e.hex)}})}))},style:{position:"relative"},children:Object(v.jsxs)(xe,{variant:"light",style:{backgroundColor:"#fff"},children:[Object(v.jsx)("i",{className:"bi bi-palette",style:{color:p}})," "]})})]}),Object(v.jsx)(le.a,{xs:4,style:{paddingRight:"5px",padding:0},children:Object(v.jsxs)("div",{children:[Object(v.jsx)("i",{className:"bi bi-border-width"})," ",Object(v.jsx)("div",{style:{display:"inline-block",verticalAlign:"middle"},children:Object(v.jsx)(Oe.a,{min:1,max:15,value:y,style:{width:"80px"},onChange:function(e){return k(e.target.value)}})})]})}),Object(v.jsxs)(le.a,{xs:4,style:{padding:0},children:[Object(v.jsx)(xe,{variant:S===de.Tools.Select?"secondary":"light",onClick:function(){return L(de.Tools.Select)},children:Object(v.jsx)("i",{className:"bi bi-hand-index-thumb"})}),Object(v.jsx)(xe,{disabled:S!==de.Tools.Select,variant:"light",onClick:function(){try{O.current.removeSelected()}catch(e){alert("\u307e\u305a\u524a\u9664\u3057\u305f\u3044\u30d1\u30fc\u30c4\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044")}},children:Object(v.jsx)("i",{className:"bi bi-trash"})}),Object(v.jsx)(xe,{disabled:S!==de.Tools.Select,variant:"light",onClick:function(){try{O.current.copy(),O.current.paste()}catch(e){alert("\u307e\u305a\u30b3\u30d4\u30da\u3057\u305f\u3044\u30d1\u30fc\u30c4\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044")}},children:Object(v.jsx)("i",{className:"bi bi-files"})})]})]}),Object(v.jsxs)(F.a,{style:{width:"100%"},children:[Object(v.jsx)(pe,{disabled:!z,variant:"light",onClick:function(){O.current.undo(),E(O.current.canUndo()),R(O.current.canRedo())},children:Object(v.jsx)("i",{className:"bi bi-arrow-90deg-left"})}),Object(v.jsx)(pe,{disabled:!B,variant:"light",onClick:function(){O.current.redo(),E(O.current.canUndo()),R(O.current.canRedo())},children:Object(v.jsx)("i",{className:"bi bi-arrow-90deg-right"})}),Object(v.jsx)(pe,{variant:"light",onClick:function(){window.confirm("\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u307e\u3059\u304b\uff1f")&&(O.current.clear(),E(O.current.canUndo()),R(O.current.canRedo()),c||me(s,O.current._fc))},children:Object(v.jsx)("i",{className:"bi bi-arrow-counterclockwise"})}),Object(v.jsxs)(pe,{variant:"light",onClick:function(){if(window.confirm("\u3042\u306a\u305f\u306e\u4f5c\u54c1\u3092\u6700\u3082\u9069\u5207\u306b\u8868\u793a\u3059\u308b\u3088\u3046\u306b\u3001\u30b9\u30de\u30db\u306e\u524d\u5f8c\u50be\u304d\u3092\u56fa\u5b9a\u3057\u3066\u304b\u3089OK\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\uff01")){var e=G;if(e){var s,l,b;alert("\u50be\u304d\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f\u3002\u4eca\u304b\u3089\u30bf\u30a4\u30d4\u30f3\u30b0\u306b\u9069\u3057\u305f\u59ff\u52e2\u306b\u5909\u3048\u3066\u3044\u305f\u3060\u3044\u3066\u3082\u5927\u4e08\u592b\u3067\u3059\u3002");var j=Object(re.b)(),u=Object(ae.b)();s=prompt("\u30bf\u30a4\u30c8\u30eb\uff1a"),l=prompt("\u3053\u306e\u4f5c\u54c1\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\uff1a"),b=Date.now(),""===s&&(s=b);var h=O.current.toDataURL();Object(re.d)(Object(re.c)(j,"paintings/"+s),h,"data_url").then((function(e){return Object(re.a)(e.ref)})).then((function(j){Promise.all([Object(ae.d)(Object(ae.c)(u,"img_urls/"+r+"/"+b),j),Object(ae.d)(Object(ae.c)(u,"img_info/"+r+"/"+b),{title:s,detail:l,angle:e,size:{width:d.width,height:d.height-120},creator_id:a.uid,prev_img_ids:!c&&Object(T.a)(Object(I.a)({},o,!0),n)}),Object(ae.d)(Object(ae.c)(u,"users/"+a.uid+"/img_ids/"+r+"/"+b),!0)]).then((function(e){var n=i.map((function(e){return e.creator_id}));Promise.all(n.map((function(e){return Object(ae.d)(Object(ae.c)(u,"users/"+e+"/notifications/"+b),{type:0,loc:r,username:a.displayName})}))).then((function(e){Object(ae.d)(Object(ae.c)(u,"users/"+a.uid+"/name"),a.displayName).then((function(e){alert("\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\uff01"),t(),window.location.href="/"+r+"?pid="+b})).catch((function(e){return alert(e)}))})).catch((function(e){return alert(e)}))})).catch((function(e){return alert(e)}))})).catch((function(e){return alert(e)}))}else alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u3082\u3046\u4e00\u5ea6\u300c\u3067\u304d\u305f\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002")}},children:[Object(v.jsx)("i",{className:"bi bi-check-lg"})," \u3067\u304d\u305f"]}),Object(v.jsxs)(pe,{variant:"light",onClick:function(){window.confirm("\u4f5c\u6210\u4e2d\u306e\u7d75\u3092\u3084\u3081\u307e\u3059\u304b\uff1f")&&t()},children:[Object(v.jsx)("i",{className:"bi bi-x-lg"})," \u3084\u3081\u308b"]})]})]})]})},we=n(103),ye=n.n(we);var ke=function(e){var t,n=e.loc,c=e.location,i=Object(H.c)(W),a=Object(h.a)(i,2),r=a[0],o=a[1],s=Object(H.c)(K),l=Object(h.a)(s,2),j=l[0],d=l[1],u=Object(H.e)(V),O=Object(b.useState)(0),f=Object(h.a)(O,2),p=f[0],g=f[1],m=Object(H.e)(G),w=Object(H.e)(Q),y=Object(b.useState)(!1),k=Object(h.a)(y,2),C=k[0],N=k[1],S=Object(b.useState)([]),L=Object(h.a)(S,2),_=L[0],P=L[1],z=Object(b.useState)(!0),E=Object(h.a)(z,2),M=E[0],A=E[1],B=Y(),U=function(e){var t=e;Array.isArray(e)||(t=Object.keys(e).map((function(t){return Object(T.a)({id:t},e[t])})));var n=ye.a.parse(c.search).pid;P(t),d(n||t[0].id);var i=n?t.map((function(e){return e.id})).indexOf(n):0;g(i),D(n||t[0].id),m(t[i].angle),w(t[i].size)},D=function(e){var t=Object(ae.b)();Object(ae.a)(Object(ae.c)(t,"img_urls/"+n+"/"+e)).then((function(e){e.exists()&&u(e.val())})).catch((function(e){return console.error(e)}))},F=function(e){var t=_;1===e?t[p].likes=Object(T.a)(Object(T.a)({},t[p].likes),{},Object(I.a)({},B.uid,!0)):delete t[p].likes[B.uid],P(t)};return Object(b.useEffect)((function(){o(n);var e=ye.a.parse(c.search),t=Object(ae.b)();Object(ae.a)(Object(ae.c)(t,"img_info/"+n)).then((function(c){if(c.exists())if(e.mode&&"base"===e.mode){var i=Object.keys(c.val()[e.bid].prev_img_ids),a={};i.forEach((function(e){a[e]=c.val()[e]})),U(a)}else e.mode&&"user"===e.mode?Object(ae.a)(Object(ae.c)(t,"users/"+e.uid+"/img_ids/"+n)).then((function(e){var t={};e.val()&&(Object.keys(e.val()).forEach((function(e){t[e]=c.val()[e]})),U(t))})):U(c.val())})).catch((function(e){return console.error(e)}))}),[]),Object(v.jsxs)("div",{children:[Object(v.jsx)(R,{switchPrev:function(){if(_.length>1){var e=0===p?_.length-1:p-1;g(e),d(_[e].id),D(_[e].id),m(_[e].angle),w(_[e].size);var t=ye.a.parse(c.search);t.pid=_[e].id;var n=window.location.origin+window.location.pathname+"?"+ye.a.stringify(t);window.history.replaceState({path:n},"",n)}},switchNext:function(){if(_.length>1){var e=p===_.length-1?0:p+1;g(e),d(_[e].id),D(_[e].id),m(_[e].angle),w(_[e].size);var t=ye.a.parse(c.search);t.pid=_[e].id;var n=window.location.origin+window.location.pathname+"?"+ye.a.stringify(t);window.history.replaceState({path:n},"",n)}}}),_.length>0?C?Object(v.jsx)(ve,{isNew:M,basePrevIds:(null===(t=_[p])||void 0===t?void 0:t.prev_img_ids)||{},closeCanvas:function(){return N(!1)},imgInfos:_}):Object(v.jsx)(ie,{imgInfo:_[p],openCanvas:function(e){var t=e.isNew;N(!0),A(t)},canvasVisibility:C,likeTrigger:function(){var e=Object(ae.b)();_[p].likes&&_[p].likes[B.uid]?Object(ae.d)(Object(ae.c)(e,"img_info/"+n+"/"+j+"/likes/"+B.uid),null).then((function(e){return F(-1)})).catch((function(e){return alert(e)})):Object(ae.d)(Object(ae.c)(e,"img_info/"+n+"/"+j+"/likes/"+B.uid),!0).then((function(t){F(1),Object(ae.d)(Object(ae.c)(e,"users/"+_[p].creator_id+"/notifications/"+j),{type:1,loc:r,username:_[p].likes&&Object.keys(_[p].likes).length>1?B.displayName+"\u3068\u4ed6\u306e"+(Object.keys(_[p].likes).length-1)+"\u4eba":B.displayName})})).catch((function(e){return alert(e)}))}}):Object(v.jsx)(x.a,{style:{position:"absolute",bottom:0,left:0,width:"100vw"},onClick:function(){N(!0),A(!0)},children:"\u3053\u306e\u5834\u6240\u3067\u521d\u306e\u4f5c\u54c1\u3092\u63cf\u3053\u3046\uff01"})]})},Ce=n(1172),Ne=n(1174),Se=n(1171),Le=["\u304c\u3042\u306a\u305f\u306e\u4f5c\u54c1\u306b\u57fa\u3065\u3044\u3066\u63cf\u304d\u307e\u3057\u305f\uff01","\u304c\u3042\u306a\u305f\u306e\u4f5c\u54c1\u306b\u300c\u3044\u3044\u306d\u300d\uff01"];var _e=function(){var e=Y(),t=Object(H.d)(W),n=Object(b.useState)("Campus as Canvas"),c=Object(h.a)(n,2),i=c[0],a=c[1],r=Object(b.useState)({}),o=Object(h.a)(r,2),s=o[0],l=o[1];return Object(b.useEffect)((function(){var n=Object(ae.b)(),c=ye.a.parse(window.location.search);c.mode&&"base"===c.mode?Object(ae.a)(Object(ae.c)(n,"img_info/"+t+"/"+c.bid+"/title")).then((function(e){a("\u300c"+e.val()+"\u300d\u306e\u30d9\u30fc\u30b9\u4f5c\u54c1")})):c.mode&&"user"===c.mode?Object(ae.a)(Object(ae.c)(n,"users/"+c.uid+"/name")).then((function(e){a(e.val()+"\u306e\u4f5c\u54c1")})):t&&a(m[t].name),e&&Object(ae.a)(Object(ae.c)(n,"users/"+e.uid+"/notifications")).then((function(e){l(e.val())}))}),[t]),Object(v.jsx)(Ce.a,{style:{position:"absolute",left:0,top:0,width:"100vw",background:"rgba(0, 0, 0, 0.3)"},children:Object(v.jsxs)(U.a,{children:[t&&Object(v.jsx)(Ce.a.Collapse,{children:Object(v.jsxs)(Ne.a,{className:"me-auto",children:[Object(v.jsx)(x.a,{style:{color:"#fff",borderColor:"#fff"},className:"btn btn-sm",variant:"outline-secondary",onClick:function(){return window.location.href="/"},children:Object(v.jsx)("i",{className:"bi bi-house"})}),Object(v.jsx)("span",{style:{width:"10px"}}),Object(v.jsx)(x.a,{style:{color:"#fff",borderColor:"#fff"},className:"btn btn-sm",variant:"outline-secondary",onClick:function(){return window.history.back()},children:Object(v.jsx)("i",{className:"bi bi-chevron-compact-left"})})]})}),Object(v.jsx)(Ce.a.Brand,{style:{color:"#fff",margin:"0px 5px"},children:i}),Object(v.jsxs)(Ce.a.Collapse,{children:[Object(v.jsx)(Ne.a,{className:"me-auto"}),Object(v.jsxs)(Ne.a,{children:[Object(v.jsxs)(Se.a,{title:Object(v.jsx)("span",{style:{color:"#fff"},children:Object(v.jsx)("i",{className:"bi bi-person-circle"})}),drop:"start",children:[Object(v.jsx)("p",{style:{textAlign:"center",marginBottom:"5px"},children:null===e||void 0===e?void 0:e.displayName}),e?Object(v.jsxs)(Se.a.Item,{style:{borderTop:"1px solid #ccc"},onClick:function(){(function(){var e=Object(X.b)();return Object(X.e)(e)})().catch((function(e){return console.error(e)}))},children:[Object(v.jsx)("i",{className:"bi bi-box-arrow-right"})," \u30ed\u30b0\u30a2\u30a6\u30c8"]}):Object(v.jsxs)(Se.a.Item,{style:{borderTop:"1px solid #ccc"},onClick:function(){q().catch((function(e){return console.error(e)}))},children:[Object(v.jsx)("i",{className:"bi bi-box-arrow-in-right"})," \u30ed\u30b0\u30a4\u30f3"]}),t&&Object(v.jsxs)(Se.a.Item,{style:{borderTop:"1px solid #ccc"},onClick:function(){window.location.href=window.location.origin+window.location.pathname+"?mode=user&uid="+e.uid},children:[Object(v.jsx)("i",{className:"bi bi-images"})," \u81ea\u5206\u306e\u7d75\u3092\u898b\u308b"]})]}),Object(v.jsxs)(Se.a,{title:Object(v.jsxs)("span",{style:{color:"#fff"},children:[Object(v.jsx)("i",{className:"bi bi-bell"}),s&&Object.keys(s).length]}),drop:"start",children:[Object(v.jsxs)("div",{style:{padding:"0px 10px"},children:[Object(v.jsx)("i",{className:"bi bi-bell"}),Object(v.jsx)(x.a,{variant:"outline-secondary",size:"sm",style:{padding:"0px 5px",margin:"0px 0px 5px 10px",border:"1px solid #ccc",color:"#aaa",float:"right"},onClick:function(){Object(ae.d)(Object(ae.c)(Object(ae.b)(),"users/"+e.uid+"/notifications/"),null),l({})},children:"\u30af\u30ea\u30a2"})]}),s&&Object.keys(s).map((function(n){return Object(v.jsx)(Se.a.Item,{style:{width:"300px",padding:0,borderTop:"1px solid #ccc"},disabled:!t||t!==s[n].loc,onClick:function(){return function(t,n){Object(ae.d)(Object(ae.c)(Object(ae.b)(),"users/"+e.uid+"/notifications/"+n),null).then((function(e){return window.location.href=window.location.origin+"/"+t+"?pid="+n})).catch((function(e){return alert(e)}))}(t,n)},children:Object(v.jsxs)(se.a,{style:{width:"100%",margin:0,padding:"5px 0px"},children:[Object(v.jsx)(le.a,{xs:1,children:Object(v.jsxs)("div",{style:{display:"flex"},children:[0===s[n].type&&Object(v.jsx)("i",{style:{color:"orange"},className:"bi bi-brush"}),1===s[n].type&&Object(v.jsx)("i",{style:{color:"red",paddingTop:"12px"},className:"bi bi-heart"})]})}),Object(v.jsxs)(le.a,{xs:11,children:[Object(v.jsxs)("small",{style:{margin:0,whiteSpace:"normal"},children:[" ",s[n].username+Le[s[n].type]]}),Object(v.jsx)("br",{}),Object(v.jsx)("small",{style:{color:"#aaa"},children:t&&t===s[n].loc?"\u30af\u30ea\u30c3\u30af\u3057\u3066\u898b\u306b\u3044\u304f":"\u3053\u306e\u5834\u6240\u306eAR\u30e2\u30fc\u30c9\u306b\u5165\u3063\u305f\u3089\u898b\u308c\u308b\u3088"})]})]})},n)}))]})]})]})]})})},Ie=function(e){var t=e.children;return function(){var e=Object(b.useState)(!0),t=Object(h.a)(e,2),n=t[0],c=t[1],i=Object(H.e)(J);return Object(b.useEffect)((function(){var e=Object(X.b)();return Object(X.c)(e,(function(e){i(e),c(!1)}))}),[i]),n}()?Object(v.jsx)("p",{children:"Loading..."}):t};var Te=function(){var e=Y();return Object(b.useEffect)((function(){window.addEventListener("popstate",(function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){console.log("Camera on")})).catch((function(e){console.error(e)}))}))})),Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(Ie,{children:Object(v.jsx)("div",{children:e?Object(v.jsxs)("div",{children:[Object(v.jsx)(_e,{}),Object(v.jsxs)(O.b,{children:[Object(v.jsx)(_,{path:"/"}),Object(v.jsx)(ke,{path:"/:loc"})]})]}):Object(v.jsxs)("div",{children:[Object(v.jsx)(_e,{}),Object(v.jsx)(x.a,{style:{marginTop:"45vh"},onClick:function(){q().catch((function(e){return console.error(e)}))},children:"Google\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3"})]})})})})},Pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1176)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),i(e),a(e),r(e)}))},ze=n(523);function Ee(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var Me=function(){var e=Object(H.d)(W),t=Object(H.d)(V),n=Object(H.d)(K),c=Object(H.d)(G),i=Object(H.d)(Q),a=Object(b.useState)(Ee()),r=Object(h.a)(a,2),o=r[0],s=r[1],l=Object(b.useState)({}),j=Object(h.a)(l,2),d=j[0],u=j[1],O=Object(b.useState)("0.3 1.5 -10"),f=Object(h.a)(O,2),x=f[0],p=f[1],g=Object(b.useState)("0 0 0"),m=Object(h.a)(g,2),w=m[0],y=m[1];return Object(b.useEffect)((function(){s(Ee());var t=Object(ae.b)();Object(ae.a)(Object(ae.c)(t,"img_urls/"+e)).then((function(e){e.exists()&&u(e.val())})).catch((function(e){return console.error(e)})),p("-0.3 ".concat(1.5-Math.round(50*Math.cos(c*Math.PI/180)*100)/100," ").concat(-1*Math.round(50*Math.sin(c*Math.PI/180)*100)/100)),y("".concat(c-90," 0 0"))}),[e]),Object(b.useEffect)((function(){p("-0.3 ".concat(1.5-Math.round(50*Math.cos(c*Math.PI/180)*100)/100," ").concat(-1*Math.round(50*Math.sin(c*Math.PI/180)*100)/100)),y("".concat(c-90," 0 0"))}),[c]),Object(v.jsxs)("a-scene",{id:"a-scene","vr-mode-ui":"enabled: false;",renderer:"logarithmicDepthBuffer: true;",arjs:"trackingMethod: best; sourceType: webcam;debugUIEnabled: false;",children:[Object(v.jsx)("a-assets",{children:d&&Object.keys(d).map((function(e){return Object(v.jsx)("img",{id:e,src:d[e],crossOrigin:"anonymous",alt:"Painting "+e},e)}))}),t&&Object(v.jsx)("a-image",{src:"#"+n,width:i?o.width/(8*o.width/414):52,height:i?i.height*o.width/i.width/(12.5*o.height/617):40,position:x,rotation:w})]})};n(1159);Object(ze.a)({apiKey:"AIzaSyAA4zXM0wRBrL1l65NHg_8mQcjg75ew9RQ",authDomain:"campus-coloring.firebaseapp.com",databaseURL:"https://campus-coloring.firebaseio.com",projectId:"campus-coloring",storageBucket:"campus-coloring.appspot.com",messagingSenderId:"45926036058",appId:"1:45926036058:web:a9271137ac86762843de63",measurementId:"G-WPPW3TX4QG"});var Ae=function(){var e=Object(H.d)(W);return Object(v.jsxs)("div",{style:{width:"100%",height:"100%"},children:[e&&Object(v.jsx)(Me,{}),Object(v.jsx)(Te,{})]})};u.a.render(Object(v.jsx)(H.a,{children:Object(v.jsx)(Ae,{})}),document.getElementById("root")),Pe()},531:function(e,t,n){},536:function(e,t,n){},671:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=671},698:function(e,t){},700:function(e,t){},723:function(e,t){},724:function(e,t){},730:function(e,t){},732:function(e,t){},764:function(e,t){},766:function(e,t){},767:function(e,t){},772:function(e,t){},774:function(e,t){},780:function(e,t){},782:function(e,t){},801:function(e,t){},813:function(e,t){},816:function(e,t){},838:function(e,t){}},[[1160,1,2]]]);
//# sourceMappingURL=main.bdc1f14d.chunk.js.map