(this["webpackJsonpcampus-coloring"]=this["webpackJsonpcampus-coloring"]||[]).push([[0],{1151:function(e,t){},1152:function(e,t){},1153:function(e,t){},1154:function(e,t){},1160:function(e,t,n){"use strict";n.r(t);var c,i,a,r,s,o,l,j=n(0),b=n.n(j),d=n(65),u=n.n(d),O=(n(531),n(239)),h=(n(536),n(537),n(538),n(11)),x=n(48),f=n(109),g=n(185),p=n(49),m={garden:{name:"\u4e2d\u5ead",description:"\u30c6\u30b9\u30c8\u7528",range:{minLat:35,maxLat:36,minLong:139,maxLong:140}},51:{name:"51\u53f7\u9928",description:"\u5317\u9580\u5bc4\u308a\u306e\u7a7a\u4e2d\u901a\u8def\u304b\u3089\u306e\u8996\u70b9",range:{minLat:35.7061,maxLat:35.7066,minLong:139.7065,maxLong:139.707}},55:{name:"55\u53f7\u9928\u5916",description:"\u5916\u306e\u5eca\u4e0b\u304b\u3089\u3001\u4e2d\u5ead\u5411\u304d\uff1b\u96e8\u5929OK",range:{minLat:35.7056,maxLat:35.7062,minLong:139.7078,maxLong:139.7083}},"51_60_top":{name:"51\u300160\u53f7\u9928\u306e\u9593",description:"59\u53f7\u9928\u5074\u306e\u7a7a\u4e2d\u901a\u8def\u304b\u3089\u306e\u8996\u70b9",range:{minLat:35.7056,maxLat:35.706,minLong:139.7061,maxLong:139.7065}},"60_61":{name:"60\u300161\u53f7\u9928\u306e\u9593",description:"59\u53f7\u9928\u5074\u306e\u5730\u9762\u901a\u8def\u304b\u3089\u306e\u8996\u70b9\uff1b\u96e8\u5929OK",range:{minLat:35.7056,maxLat:35.706,minLong:139.7057,maxLong:139.7061}}},v=n(2),w=p.a.div(c||(c=Object(x.a)(["\n  position: relative;\n  margin: 0px auto;\n  width: 400px;\n  height: 160px;\n  background-image: url('/img/map.jpeg');\n  background-size: contain;\n"]))),y=p.a.i(i||(i=Object(x.a)(["\n  position: absolute;\n  font-size: 24px;\n"]))),k=(Object(p.a)(y)(a||(a=Object(x.a)(["\ntop: 50px;\nleft: 250px;\n"]))),[{loc:"51",Pin:Object(p.a)(y)(r||(r=Object(x.a)(["\n  top: -10px;\n  left: 170px;\n"])))},{loc:"51_60_top",Pin:Object(p.a)(y)(s||(s=Object(x.a)(["\n  top: 70px;\n  left: 135px;\n"])))},{loc:"60_61",Pin:Object(p.a)(y)(o||(o=Object(x.a)(["\n  top: 70px;\n  left: 105px;\n"])))},{loc:"55",Pin:Object(p.a)(y)(l||(l=Object(x.a)(["\n  top: 50px;\n  left: 310px;\n"])))}]);var C=function(){var e=Object(j.useState)(null),t=Object(h.a)(e,2),n=t[0],c=t[1],i=Object(j.useState)(""),a=Object(h.a)(i,2),r=a[0],s=a[1],o=Object(j.useState)(!1),l=Object(h.a)(o,2),b=l[0],d=l[1],u=function(){navigator.geolocation.getCurrentPosition((function(e){c(e.coords),b&&d(!1)}),(function(e){d(!0)}))};Object(j.useEffect)((function(){u();var e=setInterval(u,5e3);return function(){return clearInterval(e)}}),[]);var x=function(e){return n&&e&&n.latitude>=e.minLat&&n.latitude<=e.maxLat&&n.longitude>=e.minLong&&n.longitude<=e.maxLong};return Object(v.jsxs)("div",{style:{paddingTop:"70px"},children:[Object(v.jsx)("h3",{children:"\u5834\u6240\u3092\u9078\u629e"}),!n&&Object(v.jsxs)("p",{children:[Object(v.jsx)("i",{className:"bi bi-arrow-clockwise"})," \u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u4e2d..."]}),b&&Object(v.jsx)("p",{style:{color:"red"},children:"\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u5931\u6557\u3002\u4f4d\u7f6e\u60c5\u5831\u306e\u53d6\u5f97\u3092\u8a31\u53ef\u3057\u3001\u906e\u853d\u7269\u306e\u306a\u3044\u7a7a\u9593\u306b\u79fb\u52d5\u3057\u3066\u6570\u79d2\u5f85\u3063\u3066\u304f\u3060\u3055\u3044\u3002"}),Object(v.jsx)(w,{children:k.map((function(e){var t=e.loc,n=e.Pin;return Object(v.jsx)(n,{onClick:function(){return s(t)},className:"bi bi-geo-alt-fill",style:{color:x(m[t].range)?"orange":"black"}},t)}))}),Object(v.jsxs)("div",{style:{textAlign:"left",padding:"20px"},children:[Object(v.jsx)("strong",{children:"\u8aac\u660e"}),Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:"\u30d4\u30f3\u3092\u30bf\u30c3\u30c1\u3059\u308b\u3068\u3001\u305d\u3053\u306e\u666f\u8272\u304c\u6620\u3063\u305f\u753b\u50cf\u304c\u8868\u793a\u3055\u308c\u307e\u3059"}),Object(v.jsx)("li",{children:"\u30d4\u30f3\u3055\u308c\u305f\u5834\u6240\u306e\u8fd1\u304f\u306b\u79fb\u52d5\u3059\u308b\u3068\u3001\u30d4\u30f3\u304c\u9ec4\u8272\u306b\u306a\u308a\u3001\u30bf\u30c3\u30c1\u3059\u308b\u3068\u7d75\u304c\u898b\u3048\u307e\u3059"}),Object(v.jsx)("li",{children:"5\u79d2\u3054\u3068\u306b\u4f4d\u7f6e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u307e\u3059"})]}),Object(v.jsx)("strong",{children:"\u5834\u6240\u4e00\u89a7"}),Object(v.jsxs)("ul",{children:[Object(v.jsxs)("li",{children:[Object(v.jsx)("b",{children:"51\u53f7\u9928"}),"\uff1a\u5317\u9580\u5bc4\u308a\u306e\u7a7a\u4e2d\u901a\u8def\u304b\u3089\u306e\u8996\u70b9"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("b",{children:"55\u53f7\u9928\u5916"}),"\uff1a\u5916\u306e\u5eca\u4e0b\u304b\u3089\u3001\u4e2d\u5ead\u5411\u304d\uff1b\u96e8\u5929OK"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("b",{children:"51\u300160\u53f7\u9928\u306e\u9593"}),"\uff1a59\u53f7\u9928\u5074\u306e\u5730\u9762\u901a\u8def\u304b\u3089\u306e\u8996\u70b9"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("b",{children:"60\u300161\u53f7\u9928\u306e\u9593"}),"\uff1a59\u53f7\u9928\u5074\u306e\u7a7a\u4e2d\u901a\u8def\u304b\u3089\u306e\u8996\u70b9\uff1b\u96e8\u5929OK"]})]})]}),Object(v.jsxs)(g.a,{centered:!0,show:""!==r,onHide:function(){return s("")},children:[Object(v.jsx)(g.a.Header,{closeButton:!0,children:Object(v.jsx)(g.a.Title,{children:r&&m[r].name})}),Object(v.jsxs)(g.a.Body,{style:{textAlign:"center"},children:[Object(v.jsx)("p",{children:r&&m[r].description}),Object(v.jsx)("img",{src:"/img/loc/".concat(r,".jpeg"),width:"80%",alt:"View of the location"}),r&&(x(m[r].range)||"garden"===r)?Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:"\u2191\u306e\u666f\u8272\u306b\u30ab\u30e1\u30e9\u3092\u5411\u3051\u3066\u304f\u3060\u3055\u3044"}),Object(v.jsx)(O.a,{to:"/"+r,children:Object(v.jsx)(f.a,{variant:"outline-primary",children:"\u7d75\u3092\u89b3\u308b"})})]}):Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:"\u3053\u306e\u5834\u6240\u306b\u79fb\u52d5\u3057\u3001\u6570\u79d2\u5f85\u3064\u3068\u7d75\u304c\u898b\u3048\u308b\u3088"}),Object(v.jsx)("p",{children:"\u79fb\u52d5\u3057\u3066\u3082\u30c0\u30e1\u3067\u3057\u305f\u3089\u3001\u753b\u9762\u3092\u66f4\u65b0\u3057\u3066\u304f\u3060\u3055\u3044"})]})]})]})]})};var N,S,L,_=function(){return Object(v.jsx)("div",{children:Object(v.jsx)(C,{})})},I=n(4),T=n(6),P=p.a.div(N||(N=Object(x.a)(["\n  position: absolute;\n  top: 50vh;\n  left: 0;\n"]))),E=p.a.div(S||(S=Object(x.a)(["\n  position: absolute;\n  top: 50vh;\n  right: 0;\n"]))),M=Object(p.a)(f.a)(L||(L=Object(x.a)(["\n  background: rgba(255, 255, 255, 0.3);\n  color: rgba(200, 200, 200);\n  border: none;\n  font-size: 36px;\n  padding: 0px;\n"])));var z,A,B=function(e){var t=e.switchPrev,n=e.switchNext;return Object(v.jsxs)(b.a.Fragment,{children:[Object(v.jsx)(P,{children:Object(v.jsx)(M,{variant:"light",onClick:t,children:Object(v.jsx)("i",{className:"bi bi-chevron-compact-left"})})}),Object(v.jsx)(E,{children:Object(v.jsx)(M,{variant:"light",onClick:n,children:Object(v.jsx)("i",{className:"bi bi-chevron-compact-right"})})})]})},R=n(1167),U=n(1168),D=n(1169),F=n(1175),H=n(33),K=Object(H.b)({key:"currentLocState",default:""}),W=Object(H.b)({key:"currentImgIdState",default:""}),V=Object(H.b)({key:"currentImgSrcState",default:""}),G=Object(H.b)({key:"currentImgAngleState",default:0}),Q=Object(H.b)({key:"currentImgSizeState",default:null}),J=Object(H.b)({key:"userState",default:null,dangerouslyAllowMutability:!0}),X=n(112),q=function(){var e=new X.a,t=Object(X.b)();return Object(X.d)(t,e)},Y=function(){return Object(H.d)(J)},Z=Object(p.a)(R.a)(z||(z=Object(x.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  background-color: rgba(248, 249, 250, 0.5);\n  padding: 10px;\n  padding-right: 20px;\n"]))),$=Object(p.a)(f.a)(A||(A=Object(x.a)(["\n  background: rgba(255, 255, 255, 0.5);\n  border: none;\n  width: 100%;\n"])));var ee,te,ne,ce=function(e){var t=e.imgInfo,n=e.openCanvas,c=e.canvasVisibility,i=e.likeTrigger,a=Y(),r=Object(j.useState)(!1),s=Object(h.a)(r,2),o=s[0],l=s[1],b=Object(j.useState)(t.likes?Object.keys(t.likes).length:0),d=Object(h.a)(b,2),u=d[0],O=d[1],x=Object(j.useState)(t.likes&&Object.keys(t.likes).includes(a.uid)),p=Object(h.a)(x,2),m=p[0],w=p[1];return Object(j.useEffect)((function(){console.log(t.likes),O(t.likes?Object.keys(t.likes).length:0),w(t.likes&&Object.keys(t.likes).includes(a.uid))}),[t]),!c&&Object(v.jsxs)(Z,{children:[Object(v.jsxs)(U.a,{children:[Object(v.jsx)(D.a,{xs:8,children:Object(v.jsx)(F.a,{style:{height:"100px",overflowY:"scroll"},children:Object(v.jsxs)(F.a.Body,{style:{padding:"5px"},children:[Object(v.jsx)(F.a.Title,{as:"h6",style:{margin:"5px"},children:t.title}),Object(v.jsx)(F.a.Text,{style:{fontSize:"14px"},children:t.detail})]})})}),Object(v.jsxs)(D.a,{xs:4,children:[Object(v.jsxs)(U.a,{children:[Object(v.jsx)(D.a,{style:{padding:0},children:Object(v.jsxs)($,{variant:"light",size:"sm",onClick:function(){window.location.href=window.location.origin+window.location.pathname+"?mode=user&uid="+t.creator_id},children:[Object(v.jsx)("i",{className:"bi bi-person"}),Object(v.jsx)("br",{}),"\u30e6\u30fc\u30b6"]})}),Object(v.jsx)(D.a,{style:{padding:0},children:Object(v.jsxs)($,{variant:"light",size:"sm",onClick:function(){i(),O(m?u-1:u+1),w(!m)},children:[Object(v.jsx)("i",{className:"bi bi-heart",style:{color:m?"red":"black"}}),Object(v.jsx)("br",{}),u]})})]}),Object(v.jsxs)(U.a,{children:[Object(v.jsx)(D.a,{style:{padding:0},children:Object(v.jsxs)($,{variant:"light",size:"sm",disabled:!t.prev_img_ids,onClick:function(){window.location.href=window.location.origin+window.location.pathname+"?mode=base&bid="+t.id},children:[Object(v.jsx)("i",{className:"bi bi-collection"}),Object(v.jsx)("br",{}),"\u524d\u4f5c\u3078"]})}),Object(v.jsx)(D.a,{style:{padding:0},children:Object(v.jsxs)($,{variant:"light",size:"sm",onClick:function(){return l(!0)},children:[Object(v.jsx)("i",{className:"bi bi-pencil"}),Object(v.jsx)("br",{}),"\u63cf\u3053\u3046"]})})]})]})]}),Object(v.jsxs)(g.a,{centered:!0,show:o,onHide:function(){return l(!1)},children:[Object(v.jsx)(g.a.Header,{closeButton:!0,children:Object(v.jsx)(g.a.Title,{children:"\u3069\u3093\u306a\u7d75\u3092\u63cf\u304d\u305f\u3044\uff1f"})}),Object(v.jsxs)(g.a.Body,{style:{textAlign:"center"},children:[Object(v.jsx)(f.a,{variant:"outline-primary",onClick:function(){n({isNew:!0}),l(!1)},children:"\u65b0\u3057\u304f\u63cf\u3053\u3046"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)(f.a,{variant:"outline-primary",onClick:function(){n({isNew:!1}),l(!1)},children:"\u3053\u308c\u3092\u30d9\u30fc\u30b9\u306b\u3057\u3066\u63cf\u3053\u3046"})]})]})]})},ie=n(27),ae=n(186),re=n(525),se=n(1170),oe=n(1173),le=n(337),je=n(61),be=n(520),de=n.n(be),ue=n(521),Oe=Object(p.a)(R.a)(ee||(ee=Object(x.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100vw;\n  height: 120px;\n  padding: 5px;\n  background-color: rgba(248, 249, 250, 0.5);\n"]))),he=Object(p.a)(f.a)(te||(te=Object(x.a)(["\n  margin: 0px;\n  margin-bottom: 2px;\n  padding: 0px;\n  width: 60px;\n  height: 35px;\n"]))),xe=Object(p.a)(he)(ne||(ne=Object(x.a)(["\n  width: 50px;\n  height: 50px;\n"])));function fe(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}function ge(e,t){ue.fabric.Image.fromURL(e,(function(e){e.scaleToWidth(fe().width),t.add(e.set({left:0,top:0}))}),{crossOrigin:"Anonymous"})}var pe=function(e){var t=e.closeCanvas,n=e.basePrevIds,c=e.isNew,i=e.imgInfos,a=Y(),r=Object(H.d)(K),s=Object(H.d)(W),o=Object(H.d)(V),l=Object(j.useState)(fe()),b=Object(h.a)(l,2),d=b[0],u=b[1],O=Object(j.useRef)(null),x=Object(j.useState)("#000"),g=Object(h.a)(x,2),p=g[0],m=g[1],w=Object(j.useState)(5),y=Object(h.a)(w,2),k=y[0],C=y[1],N=Object(j.useState)("transparent"),S=Object(h.a)(N,2),L=S[0],_=S[1],P=Object(j.useState)(je.Tools.Pencil),E=Object(h.a)(P,2),M=E[0],z=E[1],A=Object(j.useState)(!1),B=Object(h.a)(A,2),R=B[0],F=B[1],G=Object(j.useState)(!1),Q=Object(h.a)(G,2),J=Q[0],X=Q[1],q=Object(j.useState)(0),Z=Object(h.a)(q,2),$=Z[0],ee=Z[1];Object(j.useEffect)((function(){u(fe()),c||ge(o,O.current._fc)}),[c,o]),Object(j.useEffect)((function(){window.addEventListener("deviceorientation",(function(e){var t=e.beta;ee(Math.round(100*t)/100)}))}),[]);return Object(v.jsxs)("div",{style:{position:"absolute",zIndex:1e3,left:0,backgroundColor:"rgba(255, 255, 255, 0.5)",borderBottom:"5px solid #aaa"},children:[Object(v.jsx)(je.SketchField,{name:"sketch",className:"canvas-area",ref:O,lineColor:p,lineWidth:k,fillColor:L||"transparent",width:d.width,height:d.height,forceValue:!0,onChange:function(){var e,t=R,n=null===(e=O.current)||void 0===e?void 0:e.canUndo();t!==n&&F(n)},tool:M,imageFormat:"jpeg"}),Object(v.jsx)(Oe,{children:Object(v.jsxs)(U.a,{children:[Object(v.jsxs)(D.a,{xs:7,style:{paddingRight:"5px"},children:[Object(v.jsx)("div",{children:Object(v.jsxs)(se.a,{children:[Object(v.jsx)(f.a,{variant:M===je.Tools.Pencil?"secondary":"light",onClick:function(){return z(je.Tools.Pencil)},children:Object(v.jsx)("i",{className:"bi bi-pencil"})}),Object(v.jsx)(f.a,{variant:M===je.Tools.Line?"secondary":"light",onClick:function(){return z(je.Tools.Line)},children:Object(v.jsx)("i",{className:"bi bi-slash-lg"})}),Object(v.jsx)(f.a,{variant:M===je.Tools.Rectangle?"secondary":"light",onClick:function(){return z(je.Tools.Rectangle)},children:Object(v.jsx)("i",{className:"bi bi-square"})}),Object(v.jsx)(f.a,{variant:M===je.Tools.Circle?"secondary":"light",onClick:function(){return z(je.Tools.Circle)},children:Object(v.jsx)("i",{className:"bi bi-circle"})}),Object(v.jsx)(oe.a,{trigger:"click",placement:"top",overlay:function(e){return Object(v.jsxs)(re.a,Object(T.a)(Object(T.a)({},e),{},{style:Object(T.a)(Object(T.a)({},e.style),{},{padding:"10px"}),children:["\u7dda",Object(v.jsx)("br",{}),Object(v.jsx)(le.a,{id:"lineColor",color:p,onChange:function(e){return m(e.hex)}}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),"\u4e2d\u8eab"," ",Object(v.jsx)(f.a,{style:{padding:"0px 10px"},variant:"secondary",onClick:function(){return _("transparent")},children:"\u4e2d\u8eab\u306a\u3057"}),Object(v.jsx)("br",{}),Object(v.jsx)(le.a,{id:"fillColor",color:L,onChange:function(e){_(e.hex),m("#000"),m(p)}})]}))},style:{position:"relative"},children:Object(v.jsxs)(f.a,{variant:"light",style:{padding:"3px"},children:[Object(v.jsx)("i",{className:"bi bi-palette"})," ",Object(v.jsx)("span",{style:{border:"3px solid"+p,backgroundColor:L,width:"15px",height:"15px",display:"inline-block",verticalAlign:"middle"}})]})})]})}),Object(v.jsxs)("div",{children:[Object(v.jsx)("span",{style:{display:"inline-block",width:"20px"}}),Object(v.jsx)("i",{className:"bi bi-border-width"})," ",Object(v.jsx)("div",{style:{display:"inline-block",verticalAlign:"middle"},children:Object(v.jsx)(de.a,{min:1,max:30,value:k,onChange:function(e){return C(e.target.value)}})})]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(he,{variant:M===je.Tools.Select?"secondary":"light",onClick:function(){return z(je.Tools.Select)},children:Object(v.jsx)("i",{className:"bi bi-hand-index-thumb"})}),Object(v.jsx)(he,{disabled:M!==je.Tools.Select,variant:"light",onClick:function(){try{O.current.removeSelected()}catch(e){alert("\u307e\u305a\u524a\u9664\u3057\u305f\u3044\u30d1\u30fc\u30c4\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044")}},children:Object(v.jsx)("i",{className:"bi bi-trash"})}),Object(v.jsx)(he,{disabled:M!==je.Tools.Select,variant:"light",onClick:function(){try{O.current.copy(),O.current.paste()}catch(e){alert("\u307e\u305a\u30b3\u30d4\u30da\u3057\u305f\u3044\u30d1\u30fc\u30c4\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044")}},children:Object(v.jsx)("i",{className:"bi bi-files"})})]})]}),Object(v.jsxs)(D.a,{xs:5,children:[Object(v.jsxs)(se.a,{style:{marginBottom:"5px"},children:[Object(v.jsx)(xe,{disabled:!R,variant:"light",onClick:function(){O.current.undo(),F(O.current.canUndo()),X(O.current.canRedo())},children:Object(v.jsx)("i",{className:"bi bi-arrow-90deg-left"})}),Object(v.jsx)(xe,{disabled:!J,variant:"light",onClick:function(){O.current.redo(),F(O.current.canUndo()),X(O.current.canRedo())},children:Object(v.jsx)("i",{className:"bi bi-arrow-90deg-right"})}),Object(v.jsx)(xe,{variant:"light",onClick:function(){O.current.clear(),F(O.current.canUndo()),X(O.current.canRedo()),c||ge(o,O.current._fc)},children:Object(v.jsx)("i",{className:"bi bi-arrow-counterclockwise"})})]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(xe,{variant:"light",onClick:function(){if(window.confirm("\u3042\u306a\u305f\u306e\u4f5c\u54c1\u3092\u6700\u3082\u9069\u5207\u306b\u8868\u793a\u3059\u308b\u3088\u3046\u306b\u3001\u30b9\u30de\u30db\u306e\u524d\u5f8c\u50be\u304d\u3092\u56fa\u5b9a\u3057\u3066\u304b\u3089OK\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\uff01")){var e=$;if(e){var o,l,j;alert("\u50be\u304d\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f\u3002\u4eca\u304b\u3089\u30bf\u30a4\u30d4\u30f3\u30b0\u306b\u9069\u3057\u305f\u59ff\u52e2\u306b\u5909\u3048\u3066\u3044\u305f\u3060\u3044\u3066\u3082\u5927\u4e08\u592b\u3067\u3059\u3002");var b=Object(ae.b)(),u=Object(ie.b)();o=prompt("\u30bf\u30a4\u30c8\u30eb\uff1a"),l=prompt("\u3053\u306e\u4f5c\u54c1\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\uff1a"),j=Date.now(),""===o&&(o=j);var h=O.current.toDataURL();Object(ae.d)(Object(ae.c)(b,"paintings/"+o),h,"data_url").then((function(e){return Object(ae.a)(e.ref)})).then((function(b){Promise.all([Object(ie.d)(Object(ie.c)(u,"img_urls/"+r+"/"+j),b),Object(ie.d)(Object(ie.c)(u,"img_info/"+r+"/"+j),{title:o,detail:l,angle:e,size:{width:d.width,height:d.height-120},creator_id:a.uid,prev_img_ids:!c&&Object(T.a)(Object(I.a)({},s,!0),n)}),Object(ie.d)(Object(ie.c)(u,"users/"+a.uid+"/img_ids/"+r+"/"+j),!0)]).then((function(e){var n=i.map((function(e){return e.creator_id}));Promise.all(n.map((function(e){return Object(ie.d)(Object(ie.c)(u,"users/"+e+"/notifications/"+j),{type:0,loc:r,username:a.displayName})}))).then((function(e){Object(ie.d)(Object(ie.c)(u,"users/"+a.uid+"/name"),a.displayName).then((function(e){alert("\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\uff01"),t(),window.location.href="/"+r+"?pid="+j})).catch((function(e){return alert(e)}))})).catch((function(e){return alert(e)}))})).catch((function(e){return alert(e)}))})).catch((function(e){return alert(e)}))}else alert("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u3082\u3046\u4e00\u5ea6\u30c1\u30a7\u30c3\u30af\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}},children:Object(v.jsx)("i",{className:"bi bi-check-lg"})}),Object(v.jsx)(xe,{disabled:!0,variant:"secondary",onClick:function(){},children:Object(v.jsx)("i",{className:"bi bi-hdd"})}),Object(v.jsx)(xe,{variant:"light",onClick:t,children:Object(v.jsx)("i",{className:"bi bi-x-lg"})})]})]})]})})]})},me=n(103),ve=n.n(me);var we=function(e){var t,n=e.loc,c=e.location,i=Object(H.c)(K),a=Object(h.a)(i,2),r=a[0],s=a[1],o=Object(H.c)(W),l=Object(h.a)(o,2),b=l[0],d=l[1],u=Object(H.e)(V),O=Object(j.useState)(0),x=Object(h.a)(O,2),g=x[0],p=x[1],m=Object(H.e)(G),w=Object(H.e)(Q),y=Object(j.useState)(!1),k=Object(h.a)(y,2),C=k[0],N=k[1],S=Object(j.useState)([]),L=Object(h.a)(S,2),_=L[0],P=L[1],E=Object(j.useState)(!0),M=Object(h.a)(E,2),z=M[0],A=M[1],R=Y(),U=function(e){var t=e;Array.isArray(e)||(t=Object.keys(e).map((function(t){return Object(T.a)({id:t},e[t])})));var n=ve.a.parse(c.search).pid;P(t),d(n||t[0].id);var i=n?t.map((function(e){return e.id})).indexOf(n):0;p(i),D(n||t[0].id),m(t[i].angle),w(t[i].size)},D=function(e){var t=Object(ie.b)();Object(ie.a)(Object(ie.c)(t,"img_urls/"+n+"/"+e)).then((function(e){e.exists()&&u(e.val())})).catch((function(e){return console.error(e)}))},F=function(e){var t=_;1===e?t[g].likes=Object(T.a)(Object(T.a)({},t[g].likes),{},Object(I.a)({},R.uid,!0)):delete t[g].likes[R.uid],P(t)};return Object(j.useEffect)((function(){s(n);var e=ve.a.parse(c.search),t=Object(ie.b)();Object(ie.a)(Object(ie.c)(t,"img_info/"+n)).then((function(c){if(c.exists())if(e.mode&&"base"===e.mode){var i=Object.keys(c.val()[e.bid].prev_img_ids),a={};i.forEach((function(e){a[e]=c.val()[e]})),U(a)}else e.mode&&"user"===e.mode?Object(ie.a)(Object(ie.c)(t,"users/"+e.uid+"/img_ids/"+n)).then((function(e){var t={};e.val()&&(Object.keys(e.val()).forEach((function(e){t[e]=c.val()[e]})),U(t))})):U(c.val())})).catch((function(e){return console.error(e)}))}),[]),Object(v.jsxs)("div",{children:[Object(v.jsx)(B,{switchPrev:function(){if(_.length>1){var e=0===g?_.length-1:g-1;p(e),d(_[e].id),D(_[e].id),m(_[e].angle),w(_[e].size);var t=ve.a.parse(c.search);t.pid=_[e].id;var n=window.location.origin+window.location.pathname+"?"+ve.a.stringify(t);window.history.replaceState({path:n},"",n)}},switchNext:function(){if(_.length>1){var e=g===_.length-1?0:g+1;p(e),d(_[e].id),D(_[e].id),m(_[e].angle),w(_[e].size);var t=ve.a.parse(c.search);t.pid=_[e].id;var n=window.location.origin+window.location.pathname+"?"+ve.a.stringify(t);window.history.replaceState({path:n},"",n)}}}),_.length>0?Object(v.jsx)(ce,{imgInfo:_[g],openCanvas:function(e){var t=e.isNew;N(!0),A(t)},canvasVisibility:C,likeTrigger:function(){var e=Object(ie.b)();_[g].likes&&_[g].likes[R.uid]?Object(ie.d)(Object(ie.c)(e,"img_info/"+n+"/"+b+"/likes/"+R.uid),null).then((function(e){return F(-1)})).catch((function(e){return alert(e)})):Object(ie.d)(Object(ie.c)(e,"img_info/"+n+"/"+b+"/likes/"+R.uid),!0).then((function(t){F(1),Object(ie.d)(Object(ie.c)(e,"users/"+_[g].creator_id+"/notifications/"+b),{type:1,loc:r,username:_[g].likes&&Object.keys(_[g].likes).length>1?R.displayName+"\u3068\u4ed6\u306e"+(Object.keys(_[g].likes).length-1)+"\u4eba":R.displayName})})).catch((function(e){return alert(e)}))}}):Object(v.jsx)(f.a,{style:{position:"absolute",bottom:0,left:0,width:"100vw"},onClick:function(){N(!0),A(!0)},children:"\u3053\u306e\u5834\u6240\u3067\u521d\u306e\u4f5c\u54c1\u3092\u63cf\u3053\u3046\uff01"}),C&&Object(v.jsx)(pe,{isNew:z,basePrevIds:(null===(t=_[g])||void 0===t?void 0:t.prev_img_ids)||{},closeCanvas:function(){return N(!1)},imgInfos:_})]})},ye=n(1172),ke=n(1174),Ce=n(1171),Ne=["\u304c\u3042\u306a\u305f\u306e\u4f5c\u54c1\u306b\u57fa\u3065\u3044\u3066\u63cf\u304d\u307e\u3057\u305f\uff01","\u304c\u3042\u306a\u305f\u306e\u4f5c\u54c1\u306b\u300c\u3044\u3044\u306d\u300d\uff01"];var Se=function(){var e=Y(),t=Object(H.d)(K),n=Object(j.useState)("Campus as Canvas"),c=Object(h.a)(n,2),i=c[0],a=c[1],r=Object(j.useState)({}),s=Object(h.a)(r,2),o=s[0],l=s[1];return Object(j.useEffect)((function(){var n=Object(ie.b)(),c=ve.a.parse(window.location.search);c.mode&&"base"===c.mode?Object(ie.a)(Object(ie.c)(n,"img_info/"+t+"/"+c.bid+"/title")).then((function(e){a("\u300c"+e.val()+"\u300d\u306e\u30d9\u30fc\u30b9\u4f5c\u54c1")})):c.mode&&"user"===c.mode?Object(ie.a)(Object(ie.c)(n,"users/"+c.uid+"/name")).then((function(e){a(e.val()+"\u306e\u4f5c\u54c1")})):t&&a(m[t].name),e&&Object(ie.a)(Object(ie.c)(n,"users/"+e.uid+"/notifications")).then((function(e){l(e.val())}))}),[t]),Object(v.jsx)(ye.a,{style:{position:"absolute",left:0,top:0,width:"100vw",background:"rgba(255, 255, 255, 0.5)"},children:Object(v.jsxs)(R.a,{children:[t&&Object(v.jsx)(ye.a.Collapse,{children:Object(v.jsxs)(ke.a,{className:"me-auto",children:[Object(v.jsx)(f.a,{className:"btn btn-sm",variant:"outline-secondary",onClick:function(){return window.location.href="/"},children:Object(v.jsx)("i",{className:"bi bi-house"})}),Object(v.jsx)("span",{style:{width:"10px"}}),Object(v.jsx)(f.a,{className:"btn btn-sm",variant:"outline-secondary",onClick:function(){return window.history.back()},children:Object(v.jsx)("i",{className:"bi bi-chevron-compact-left"})})]})}),Object(v.jsx)(ye.a.Brand,{children:i}),Object(v.jsxs)(ye.a.Collapse,{children:[Object(v.jsx)(ke.a,{className:"me-auto"}),Object(v.jsxs)(ke.a,{children:[Object(v.jsxs)(Ce.a,{title:Object(v.jsxs)("span",{children:[Object(v.jsx)("i",{className:"bi bi-bell"}),o&&Object.keys(o).length]}),drop:"start",children:[Object(v.jsx)(f.a,{variant:"outline-primary",size:"sm",style:{marginLeft:"10px"},onClick:function(){Object(ie.d)(Object(ie.c)(Object(ie.b)(),"users/"+e.uid+"/notifications/"),null),l({})},children:"\u30af\u30ea\u30a2"}),o&&Object.keys(o).map((function(n){return Object(v.jsxs)(Ce.a.Item,{disabled:!t||t!==o[n].loc,onClick:function(){return function(t,n){Object(ie.d)(Object(ie.c)(Object(ie.b)(),"users/"+e.uid+"/notifications/"+n),null).then((function(e){return window.location.href=window.location.origin+"/"+t+"?pid="+n})).catch((function(e){return alert(e)}))}(t,n)},children:[o[n].username+Ne[o[n].type],Object(v.jsx)("br",{}),Object(v.jsx)("small",{children:t&&t===o[n].loc?"\u30af\u30ea\u30c3\u30af\u3057\u3066\u898b\u306b\u3044\u304f":"\u3053\u306e\u5834\u6240\u306eAR\u30e2\u30fc\u30c9\u306b\u5165\u3063\u305f\u3089\u898b\u308c\u308b\u3088"})]},n)}))]}),Object(v.jsxs)(Ce.a,{title:Object(v.jsx)("i",{className:"bi bi-person-circle"}),drop:"start",children:[Object(v.jsx)("p",{style:{textAlign:"center"},children:null===e||void 0===e?void 0:e.displayName}),e?Object(v.jsx)(Ce.a.Item,{onClick:function(){(function(){var e=Object(X.b)();return Object(X.e)(e)})().catch((function(e){return console.error(e)}))},children:"\u30ed\u30b0\u30a2\u30a6\u30c8"}):Object(v.jsx)(Ce.a.Item,{onClick:function(){q().catch((function(e){return console.error(e)}))},children:"\u30ed\u30b0\u30a4\u30f3"}),t&&Object(v.jsxs)(Ce.a.Item,{onClick:function(){window.location.href=window.location.origin+window.location.pathname+"?mode=user&uid="+e.uid},children:["\u81ea\u5206\u306e\u7d75\u3092\u898b\u308b\uff1a",Object(v.jsx)("br",{})," ",m[t].name]})]})]})]})]})})},Le=function(e){var t=e.children;return function(){var e=Object(j.useState)(!0),t=Object(h.a)(e,2),n=t[0],c=t[1],i=Object(H.e)(J);return Object(j.useEffect)((function(){var e=Object(X.b)();return Object(X.c)(e,(function(e){i(e),c(!1)}))}),[i]),n}()?Object(v.jsx)("p",{children:"Loading..."}):t};var _e=function(){var e=Y();return Object(j.useEffect)((function(){window.addEventListener("popstate",(function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){console.log("Camera on")})).catch((function(e){console.error(e)}))}))})),Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(Le,{children:Object(v.jsx)("div",{children:e?Object(v.jsxs)("div",{children:[Object(v.jsx)(Se,{}),Object(v.jsxs)(O.b,{children:[Object(v.jsx)(_,{path:"/"}),Object(v.jsx)(we,{path:"/:loc"})]})]}):Object(v.jsxs)("div",{children:[Object(v.jsx)(Se,{}),Object(v.jsx)(f.a,{style:{marginTop:"45vh"},onClick:function(){q().catch((function(e){return console.error(e)}))},children:"Google\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3"})]})})})})},Ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1176)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),i(e),a(e),r(e)}))},Te=n(524);function Pe(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var Ee=function(){var e=Object(H.d)(K),t=Object(H.d)(V),n=Object(H.d)(W),c=Object(H.d)(G),i=Object(H.d)(Q),a=Object(j.useState)(Pe()),r=Object(h.a)(a,2),s=r[0],o=r[1],l=Object(j.useState)({}),b=Object(h.a)(l,2),d=b[0],u=b[1],O=Object(j.useState)("0.3 1.5 -10"),x=Object(h.a)(O,2),f=x[0],g=x[1],p=Object(j.useState)("0 0 0"),m=Object(h.a)(p,2),w=m[0],y=m[1];return Object(j.useEffect)((function(){o(Pe());var t=Object(ie.b)();Object(ie.a)(Object(ie.c)(t,"img_urls/"+e)).then((function(e){e.exists()&&u(e.val())})).catch((function(e){return console.error(e)})),g("-0.3 ".concat(1.5-Math.round(50*Math.cos(c*Math.PI/180)*100)/100," ").concat(-1*Math.round(50*Math.sin(c*Math.PI/180)*100)/100)),y("".concat(c-90," 0 0"))}),[e]),Object(j.useEffect)((function(){g("-0.3 ".concat(1.5-Math.round(50*Math.cos(c*Math.PI/180)*100)/100," ").concat(-1*Math.round(50*Math.sin(c*Math.PI/180)*100)/100)),y("".concat(c-90," 0 0"))}),[c]),Object(v.jsxs)("a-scene",{id:"a-scene","vr-mode-ui":"enabled: false;",renderer:"logarithmicDepthBuffer: true;",arjs:"trackingMethod: best; sourceType: webcam;debugUIEnabled: false;",children:[Object(v.jsx)("a-assets",{children:d&&Object.keys(d).map((function(e){return Object(v.jsx)("img",{id:e,src:d[e],crossOrigin:"anonymous",alt:"Painting "+e},e)}))}),t&&Object(v.jsx)("a-image",{src:"#"+n,width:i?s.width/(8*s.width/414):52,height:i?i.height*s.width/i.width/(12.5*s.height/617):40,position:f,rotation:w})]})};n(1159);Object(Te.a)({apiKey:"AIzaSyAA4zXM0wRBrL1l65NHg_8mQcjg75ew9RQ",authDomain:"campus-coloring.firebaseapp.com",databaseURL:"https://campus-coloring.firebaseio.com",projectId:"campus-coloring",storageBucket:"campus-coloring.appspot.com",messagingSenderId:"45926036058",appId:"1:45926036058:web:a9271137ac86762843de63",measurementId:"G-WPPW3TX4QG"});var Me=function(){var e=Object(H.d)(K);return Object(v.jsxs)("div",{style:{width:"100%",height:"100%"},children:[e&&Object(v.jsx)(Ee,{}),Object(v.jsx)(_e,{})]})};u.a.render(Object(v.jsx)(H.a,{children:Object(v.jsx)(Me,{})}),document.getElementById("root")),Ie()},531:function(e,t,n){},536:function(e,t,n){},671:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=671},698:function(e,t){},700:function(e,t){},723:function(e,t){},724:function(e,t){},730:function(e,t){},732:function(e,t){},764:function(e,t){},766:function(e,t){},767:function(e,t){},772:function(e,t){},774:function(e,t){},780:function(e,t){},782:function(e,t){},801:function(e,t){},813:function(e,t){},816:function(e,t){},838:function(e,t){}},[[1160,1,2]]]);
//# sourceMappingURL=main.63d5a4a3.chunk.js.map